<!DOCTYPE html>
<html lang="zh">

<head>
	<link rel="icon" href="../Common/images/favicon.ico"> 
	<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>QQ空间备份-日志 Demo</title>
	<link rel="stylesheet" href="../Common/vendor/css/font-awesome.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../Common/css/common.css">
	<script src="../Common/vendor/js/jquery.min.js"></script>
	<script src="../Common/vendor/js/bootstrap.bundle.min.js"></script>
	<script src="../Common/vendor/js/lodash.min.js"></script>
	
	<script type="text/javascript" src="../Common/json/config.js"></script>
	<script type="text/javascript" src="json/blogs.js"></script>
	
	<style>
		/* 始终显示滚动条，避免切换时布局偏移 */
		html {
			overflow-y: scroll;
		}
		
		/* Demo 标记 */
		.demo-badge {
			position: fixed;
			top: 80px;
			right: 20px;
			background: linear-gradient(135deg, #ff6b6b, #ee5a24);
			color: #fff;
			padding: 8px 16px;
			border-radius: 20px;
			font-weight: 600;
			font-size: 14px;
			box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
			z-index: 1000;
		}
	</style>
</head>

<body class="blogs-page">
	<!-- Demo 标记 -->
	<div class="demo-badge">
		<i class="fa fa-star mr-1"></i>Demo 演示
	</div>
	
	<header>
		<nav class="navbar navbar-expand-lg navbar-dark fixed-top blogs-navbar">
			<a class="navbar-brand" href="../index.html">
				<i class="fa fa-cloud-download mr-2"></i>QQ空间导出助手
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb blogs-breadcrumb">
						<li class="breadcrumb-item"><a href="../index.html"><i class="fa fa-home mr-1"></i>个人中心</a></li>
						<li class="breadcrumb-item active"><i class="fa fa-book mr-1"></i>日志</li>
					</ol>
				</nav>
			</div>
		</nav>
	</header>
	
	<main role="main" class="flex-shrink-0">
		<div class="container">
			<div class="blogs-main-card">
				<!-- 页面标题 -->
				<div class="blogs-header">
					<i class="fa fa-book blogs-header-icon"></i>
					<h1 class="blogs-header-title">我的日志</h1>
					<p class="blogs-header-subtitle">共 <span class="blogs-total-count" id="totalCount">0</span> 篇日志</p>
				</div>
				
				<!-- 分类标签 -->
				<div class="blogs-categories" id="categories">
					<!-- 由JS动态生成 -->
				</div>
				
				<!-- 日志列表 -->
				<div class="blogs-grid" id="blogsList">
					<!-- 由JS动态生成 -->
				</div>
			</div>
		</div>
	</main>
	
	<!-- 日志详情弹窗 -->
	<div class="modal fade" id="blogModal" tabindex="-1">
		<div class="modal-dialog modal-lg modal-dialog-scrollable">
			<div class="modal-content" style="border-radius: 20px; overflow: hidden;">
				<div class="modal-header" style="background: linear-gradient(135deg, #667eea, #764ba2); color: #fff;">
					<h5 class="modal-title" id="blogModalTitle">日志标题</h5>
					<button type="button" class="close text-white" data-dismiss="modal">
						<span>&times;</span>
					</button>
				</div>
				<div class="modal-body" id="blogModalBody" style="padding: 30px;">
					<!-- 日志内容 -->
				</div>
				<div class="modal-footer">
					<span class="text-muted mr-auto" id="blogModalMeta"></span>
					<button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
				</div>
			</div>
		</div>
	</div>
	
	<footer class="footer mt-auto py-3 blogs-footer">
		<div class="container text-center">
			<span class="text-white footer-text">
				<i class="fa fa-leaf mr-2"></i>落叶随风，青春，稀纵即逝
			</span>
		</div>
	</footer>
	
	<script>
		// 渲染日志列表
		function renderBlogs() {
			const container = document.getElementById('blogsList');
			const categoriesContainer = document.getElementById('categories');
			
			// 统计分类
			const categories = {};
			blogs.forEach(blog => {
				const cat = blog.category || '未分类';
				categories[cat] = (categories[cat] || 0) + 1;
			});
			
			// 渲染分类标签
			let catHtml = `<a class="category-tag active" data-category="all">全部 <span class="count">${blogs.length}</span></a>`;
			Object.keys(categories).forEach(cat => {
				catHtml += `<a class="category-tag" data-category="${cat}">${cat} <span class="count">${categories[cat]}</span></a>`;
			});
			categoriesContainer.innerHTML = catHtml;
			
			// 渲染日志卡片
			let html = '';
			blogs.forEach(blog => {
				const isRepost = blog.effect === 1;
				html += `
					<div class="blog-card" data-category="${blog.category}" onclick="showBlog('${blog.blogid}')">
						${isRepost ? '<div class="blog-labels"><span class="blog-label repost">转载</span></div>' : '<div class="blog-labels"><span class="blog-label original">原创</span></div>'}
						<h3 class="blog-title">${blog.title}</h3>
						<span class="blog-category">${blog.category}</span>
						<div class="blog-meta">
							<span class="blog-time"><i class="fa fa-clock-o"></i>${blog.pubTime}</span>
							<div class="blog-stats">
								<span><i class="fa fa-eye"></i> ${blog.custom_visitor?.viewCount || 0}</span>
								<span><i class="fa fa-comment"></i> ${blog.replynum || 0}</span>
							</div>
						</div>
					</div>
				`;
			});
			container.innerHTML = html;
			
			document.getElementById('totalCount').textContent = blogs.length;
			
			// 绑定分类筛选
			document.querySelectorAll('.category-tag').forEach(tag => {
				tag.addEventListener('click', function() {
					document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));
					this.classList.add('active');
					
					const category = this.dataset.category;
					document.querySelectorAll('.blog-card').forEach(card => {
						if (category === 'all' || card.dataset.category === category) {
							card.style.display = '';
						} else {
							card.style.display = 'none';
						}
					});
				});
			});
		}
		
		// 显示日志详情
		function showBlog(blogid) {
			const blog = blogs.find(b => b.blogid === blogid);
			if (!blog) return;
			
			document.getElementById('blogModalTitle').textContent = blog.title;
			document.getElementById('blogModalBody').innerHTML = blog.content;
			document.getElementById('blogModalMeta').innerHTML = `
				<i class="fa fa-folder-o mr-1"></i>${blog.category} · 
				<i class="fa fa-clock-o mr-1"></i>${blog.pubTime} · 
				<i class="fa fa-eye mr-1"></i>${blog.custom_visitor?.viewCount || 0} · 
				<i class="fa fa-comment mr-1"></i>${blog.replynum || 0}
			`;
			
			$('#blogModal').modal('show');
		}
		
		// 初始化
		document.addEventListener('DOMContentLoaded', renderBlogs);
	</script>
</body>

</html>
