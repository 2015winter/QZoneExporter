<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<link rel="icon" href="../Common/images/favicon.ico"> 
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>QQç©ºé—´å¤‡ä»½-åˆ†äº«</title>
	<link rel="stylesheet" href="../Common/vendor/css/font-awesome.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/bootstrap.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/lightgallery.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/lightgallery-bundle.min.css">
	<link rel="stylesheet" type="text/css" href="../Common/css/common.css">
	<script src="../Common/vendor/js/jquery.min.js"></script>
	<script src="../Common/vendor/js/bootstrap.bundle.min.js"></script>
	<script src="../Common/vendor/js/lodash.min.js"></script>
	
	<script src="../Common/vendor/js/lightgallery.min.js"></script>
	<script src="../Common/vendor/js/lg-zoom.min.js"></script>
	<script src="../Common/vendor/js/lg-video.min.js"></script>
	<script src="../Common/vendor/js/lg-thumbnail.min.js"></script>
	<script src="../Common/vendor/js/lg-rotate.min.js"></script>
	<script src="../Common/vendor/js/lg-fullscreen.min.js"></script>
	<script src="../Common/vendor/js/lg-comment.min.js"></script>
	<script src="../Common/vendor/js/lg-autoplay.min.js"></script>
	
	<script src="../Common/vendor/js/jquery.mousewheel.min.js"></script>
	<script src="../Common/vendor/js/lazyload.min.js"></script>
	<script src="../Common/vendor/js/index.aio.min.js"></script>
	<script src="../Common/vendor/js/clicklove.min.js"></script>
	
	<script type="text/javascript" src="../Common/json/config.js"></script>
	<script type="text/javascript" src="json/shares.js"></script>
	<script type="text/javascript" src="../Common/js/common.js"></script>
	<script type="text/javascript" src="js/shares.js"></script>
	
	<style>
		/* åˆ†äº«é¡µé¢ä¸“å±æ ·å¼ - æµ…ç´«è‰²ä¸»é¢˜ #a29bfe */
		:root {
			--primary-gradient: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
			--card-shadow: 0 4px 15px rgba(162, 155, 254, 0.2);
			--primary-color: #a29bfe;
			--primary-dark: #6c5ce7;
		}
		
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		
		/* å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œé¿å…åˆ‡æ¢æ—¶å¸ƒå±€åç§» */
		html {
			overflow-y: scroll;
		}
		
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
			background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
			min-height: 100vh;
			padding: 20px;
			padding-top: 80px;
			padding-bottom: 80px;
		}
		
		/* å¯¼èˆªæ æ ·å¼ */
		.shares-navbar {
			background: var(--primary-gradient) !important;
			backdrop-filter: blur(10px);
		}
		
		.shares-breadcrumb {
			background: transparent !important;
			margin-bottom: 0;
			padding-top: 8px;
		}
		
		.shares-breadcrumb .breadcrumb-item a {
			color: rgba(255, 255, 255, 0.85);
			transition: color 0.3s ease;
		}
		
		.shares-breadcrumb .breadcrumb-item a:hover {
			color: #fff;
			text-decoration: none;
		}
		
		.shares-breadcrumb .breadcrumb-item.active {
			color: rgba(255, 255, 255, 0.9);
		}
		
		.shares-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
			color: rgba(255, 255, 255, 0.5);
		}
		
		/* ä¸»å¡ç‰‡å®¹å™¨ - æ”¶è—é¡µé£æ ¼ */
		.shares-main-card {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(20px);
			border-radius: 24px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
			padding: 40px;
			max-width: 1200px;
			margin: 0 auto;
		}
		
		/* é¡µé¢æ ‡é¢˜åŒºåŸŸ - æ”¶è—é¡µé£æ ¼ */
		.shares-header {
			text-align: center;
			margin-bottom: 40px;
			padding-bottom: 30px;
			border-bottom: 1px solid rgba(0, 0, 0, 0.08);
		}
		
		.shares-header-icon {
			font-size: 48px;
			background: var(--primary-gradient);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 16px;
			display: block;
		}
		
		.shares-header-title {
			font-size: 32px;
			font-weight: 700;
			background: var(--primary-gradient);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 12px;
		}
		
		.shares-header-subtitle {
			color: #718096;
			font-size: 16px;
		}
		
		.shares-total-count {
			font-weight: 600;
			color: var(--primary-color);
		}
		
		/* ç­›é€‰æ ‡ç­¾åŒºåŸŸ - æ”¶è—é¡µé£æ ¼ */
		.shares-filters {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
			justify-content: center;
			margin-bottom: 32px;
			padding-bottom: 24px;
			border-bottom: 1px solid rgba(0, 0, 0, 0.06);
		}
		
		.filter-tag {
			display: inline-flex;
			align-items: center;
			gap: 8px;
			padding: 10px 20px;
			background: linear-gradient(145deg, #f8fafc, #fff);
			border: 1px solid rgba(162, 155, 254, 0.15);
			border-radius: 30px;
			font-size: 14px;
			color: #4a5568;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			text-decoration: none;
		}
		
		.filter-tag:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(162, 155, 254, 0.2);
			background: var(--primary-gradient);
			color: #fff;
			text-decoration: none;
		}
		
		.filter-tag.active {
			background: var(--primary-gradient);
			color: #fff;
			border-color: transparent;
			box-shadow: 0 6px 20px rgba(162, 155, 254, 0.3);
		}
		
		.filter-tag .count {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			min-width: 24px;
			height: 24px;
			padding: 0 8px;
			background: rgba(162, 155, 254, 0.1);
			border-radius: 12px;
			font-size: 12px;
			font-weight: 600;
			color: var(--primary-color);
			transition: all 0.3s ease;
		}
		
		.filter-tag:hover .count,
		.filter-tag.active .count {
			background: rgba(255, 255, 255, 0.25);
			color: #fff;
		}
		
		/* åˆ†äº«å¡ç‰‡ç½‘æ ¼ - æ”¶è—é¡µé£æ ¼ */
		.shares-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
			gap: 20px;
		}
		
		/* åˆ†äº«å¡ç‰‡ - æ”¶è—é¡µé£æ ¼ */
		.share-card {
			background: #fff;
			border-radius: 16px;
			overflow: hidden;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
			transition: all 0.3s ease;
			cursor: pointer;
			display: flex;
			flex-direction: column;
			height: 100%;
		}
		
		.share-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(162, 155, 254, 0.2);
		}
		
		.share-card.active {
			box-shadow: 0 0 0 3px var(--primary-color), 0 10px 30px rgba(162, 155, 254, 0.3);
			transform: translateY(-5px);
		}
		
		.share-card-cover {
			width: 100%;
			height: 180px;
			object-fit: cover;
			transition: transform 0.3s ease;
			background: linear-gradient(135deg, #e8e4ff 0%, #d4d0f7 100%);
		}
		
		.share-card:hover .share-card-cover {
			transform: scale(1.05);
		}
		
		.share-card-content {
			padding: 20px;
			flex: 1;
			display: flex;
			flex-direction: column;
		}
		
		.share-card-type {
			display: inline-flex;
			align-items: center;
			gap: 5px;
			padding: 4px 12px;
			border-radius: 12px;
			font-size: 12px;
			font-weight: 600;
			margin-bottom: 10px;
			align-self: flex-start;
			background: rgba(162, 155, 254, 0.15);
			color: var(--primary-dark);
		}
		
		.share-card-title {
			font-size: 16px;
			font-weight: 600;
			color: #333;
			margin-bottom: 8px;
			line-height: 1.4;
			display: -webkit-box;
			-webkit-line-clamp: 2;
			-webkit-box-orient: vertical;
			overflow: hidden;
		}
		
		.share-card-summary {
			font-size: 14px;
			color: #666;
			line-height: 1.6;
			display: -webkit-box;
			-webkit-line-clamp: 3;
			-webkit-box-orient: vertical;
			overflow: hidden;
			margin-bottom: 12px;
			flex: 1;
		}
		
		.share-card-meta {
			display: flex;
			justify-content: space-between;
			align-items: center;
			font-size: 12px;
			color: #999;
			margin-top: auto;
		}
		
		.share-card-source {
			display: flex;
			align-items: center;
			gap: 5px;
		}
		
		.share-card-actions {
			display: flex;
			gap: 12px;
		}
		
		.share-card-actions span {
			display: flex;
			align-items: center;
			gap: 4px;
		}
		
		/* ç©ºçŠ¶æ€ */
		.shares-empty {
			text-align: center;
			padding: 60px 20px;
			color: #718096;
			display: none;
		}
		
		.shares-empty i {
			font-size: 64px;
			margin-bottom: 20px;
			opacity: 0.3;
		}
		
		.shares-empty p {
			font-size: 16px;
		}
		
		/* åº•éƒ¨é¡µè„š */
		.shares-footer {
			background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9));
			backdrop-filter: blur(10px);
			position: fixed;
			bottom: 0;
			left: calc(100vw - 100%);
			right: 0;
			z-index: 1000;
			padding: 15px;
			text-align: center;
		}
		
		.footer-text {
			font-size: 14px;
			letter-spacing: 1px;
			color: #fff;
		}
		
		/* ========== ä¾§è¾¹æ»‘å‡ºé¢æ¿æ ·å¼ ========== */
		
		/* é®ç½©å±‚ */
		.detail-overlay {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			z-index: 1999;
			opacity: 0;
			visibility: hidden;
			transition: all 0.3s ease;
			backdrop-filter: blur(4px);
		}
		
		.detail-overlay.show {
			opacity: 1;
			visibility: visible;
		}
		
		/* ä¾§è¾¹é¢æ¿ */
		.detail-panel {
			position: fixed;
			top: 0;
			right: 0;
			width: 620px;
			max-width: 100%;
			height: 100vh;
			background: #fff;
			z-index: 2000;
			transform: translateX(100%);
			transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
			display: flex;
			flex-direction: column;
			box-shadow: -10px 0 40px rgba(0, 0, 0, 0.15);
		}
		
		.detail-panel.show {
			transform: translateX(0);
		}
		
		/* é¢æ¿å¤´éƒ¨ */
		.panel-header {
			padding: 20px 24px;
			background: var(--primary-gradient);
			display: flex;
			align-items: center;
			justify-content: space-between;
			flex-shrink: 0;
		}
		
		.panel-nav {
			display: flex;
			align-items: center;
			gap: 8px;
		}
		
		.panel-nav-btn {
			width: 38px;
			height: 38px;
			border-radius: 10px;
			background: rgba(255, 255, 255, 0.2);
			border: none;
			cursor: pointer;
			color: #fff;
			font-size: 16px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.2s ease;
		}
		
		.panel-nav-btn:hover:not(:disabled) {
			background: rgba(255, 255, 255, 0.35);
			transform: scale(1.05);
		}
		
		.panel-nav-btn:disabled {
			opacity: 0.4;
			cursor: not-allowed;
		}
		
		.panel-counter {
			color: #fff;
			font-size: 14px;
			font-weight: 500;
			padding: 0 12px;
		}
		
		.panel-close {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			background: rgba(255, 255, 255, 0.2);
			border: none;
			cursor: pointer;
			color: #fff;
			font-size: 20px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.25s ease;
		}
		
		.panel-close:hover {
			background: rgba(255, 255, 255, 0.35);
			transform: rotate(90deg);
		}
		
		/* é¢æ¿å†…å®¹ */
		.panel-body {
			flex: 1;
			overflow-y: auto;
			overflow-x: hidden;
			padding: 0;
		}
		
		/* ========== è¯¦æƒ…å†…å®¹æ ·å¼ - ä¿ç•™åŸåˆ†äº«å†…å®¹æ ·å¼ ========== */
		
		/* è¯¦æƒ…å¤´éƒ¨ */
		.detail-header {
			padding: 20px;
			border-bottom: 1px solid #f0f0f0;
		}
		
		.detail-user {
			display: flex;
			align-items: center;
			gap: 12px;
		}
		
		.detail-avatar {
			width: 50px;
			height: 50px;
			border-radius: 50%;
			object-fit: cover;
			border: 2px solid var(--primary-color);
		}
		
		.detail-user-info {
			flex: 1;
		}
		
		.detail-user-name {
			font-weight: 600;
			color: #333;
			font-size: 16px;
		}
		
		.detail-user-name a {
			color: inherit;
			text-decoration: none;
		}
		
		.detail-user-name a:hover {
			color: var(--primary-dark);
		}
		
		.detail-time {
			font-size: 13px;
			color: #999;
			margin-top: 4px;
		}
		
		.detail-type {
			display: inline-flex;
			align-items: center;
			gap: 5px;
			padding: 4px 12px;
			border-radius: 12px;
			font-size: 12px;
			background: rgba(162, 155, 254, 0.15);
			color: var(--primary-dark);
		}
		
		/* åˆ†äº«æè¿° */
		.detail-desc {
			font-size: 16px;
			color: #333;
			line-height: 1.8;
			padding: 20px;
			border-bottom: 1px solid #f0f0f0;
		}
		
		/* åˆ†äº«æ¥æºå†…å®¹ */
		.detail-source {
			margin: 20px;
			padding: 15px;
			background: #f8f9fa;
			border-radius: 12px;
			border-left: 4px solid var(--primary-color);
			cursor: pointer;
			transition: background 0.3s;
		}
		
		.detail-source:hover {
			background: #f0f1f2;
		}
		
		.detail-source-title {
			font-size: 16px;
			font-weight: 600;
			color: #333;
			margin-bottom: 8px;
			line-height: 1.5;
		}
		
		.detail-source-title a {
			color: inherit;
			text-decoration: none;
		}
		
		.detail-source-title a:hover {
			color: var(--primary-dark);
		}
		
		.detail-source-summary {
			font-size: 14px;
			color: #666;
			line-height: 1.6;
			margin-bottom: 8px;
		}
		
		.detail-source-from {
			font-size: 12px;
			color: #999;
		}
		
		/* åˆ†äº«åª’ä½“åŒºåŸŸ */
		.detail-medias {
			margin: 0 20px 20px;
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
		}
		
		.detail-medias .medias-item {
			border-radius: 8px;
			overflow: hidden;
			cursor: pointer;
		}
		
		.detail-medias .medias-item img {
			width: 100px;
			height: 100px;
			object-fit: cover;
			transition: transform 0.3s;
		}
		
		.detail-medias .medias-item:hover img {
			transform: scale(1.05);
		}
		
		/* ç»Ÿè®¡ä¿¡æ¯ */
		.detail-stats {
			padding: 15px 20px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-top: 1px solid #f0f0f0;
			background: #fafafa;
		}
		
		.detail-floor {
			font-size: 12px;
			background: linear-gradient(135deg, rgba(162, 155, 254, 0.1), rgba(108, 92, 231, 0.1));
			padding: 4px 10px;
			border-radius: 10px;
			color: var(--primary-dark);
		}
		
		.detail-actions {
			display: flex;
			gap: 20px;
		}
		
		.detail-action-item {
			display: flex;
			align-items: center;
			gap: 5px;
			font-size: 13px;
			color: #666;
			cursor: pointer;
			transition: color 0.3s;
		}
		
		.detail-action-item:hover {
			color: var(--primary-dark);
		}
		
		.detail-action-item .fa {
			color: var(--primary-dark);
		}
		
		/* è¯„è®ºåŒº */
		.detail-comments {
			padding: 20px;
			border-top: 1px solid #f0f0f0;
		}
		
		.detail-comments-title {
			font-size: 14px;
			color: #666;
			margin-bottom: 16px;
			padding-bottom: 12px;
			border-bottom: 1px dashed #eee;
		}
		
		.detail-comment-item {
			display: flex;
			gap: 10px;
			margin-bottom: 12px;
			padding: 12px;
			background: #f8f9fa;
			border-radius: 10px;
		}
		
		.detail-comment-item:last-child {
			margin-bottom: 0;
		}
		
		.detail-comment-avatar {
			width: 36px;
			height: 36px;
			border-radius: 50%;
			object-fit: cover;
			flex-shrink: 0;
		}
		
		.detail-comment-body {
			flex: 1;
		}
		
		.detail-comment-user {
			font-size: 13px;
			font-weight: 500;
			color: #333;
			margin-bottom: 4px;
		}
		
		.detail-comment-user a {
			color: inherit;
			text-decoration: none;
		}
		
		.detail-comment-user a:hover {
			color: var(--primary-dark);
		}
		
		.detail-comment-text {
			font-size: 13px;
			color: #666;
			line-height: 1.5;
		}
		
		.detail-comment-time {
			font-size: 11px;
			color: #999;
			margin-top: 4px;
		}
		
		.detail-comment-images {
			margin-top: 8px;
			display: flex;
			flex-wrap: wrap;
			gap: 6px;
		}
		
		.detail-comment-images img {
			width: 60px;
			height: 60px;
			object-fit: cover;
			border-radius: 6px;
			cursor: pointer;
		}
		
		/* å›å¤æ ·å¼ */
		.detail-reply-item {
			margin-top: 10px;
			padding: 10px;
			background: #fff;
			border-radius: 8px;
			border-left: 3px solid var(--primary-color);
		}
		
		/* ç§å¯†æ ‡è®° */
		.private-tag {
			color: #f39c12;
			font-size: 12px;
			margin-left: 8px;
		}
		
		/* é”®ç›˜æç¤º */
		.panel-tips {
			padding: 12px 24px;
			background: #f8fafc;
			border-top: 1px solid #edf2f7;
			font-size: 12px;
			color: #a0aec0;
			text-align: center;
			flex-shrink: 0;
		}
		
		.panel-tips kbd {
			display: inline-block;
			padding: 2px 6px;
			background: #e2e8f0;
			border-radius: 4px;
			font-family: inherit;
			font-size: 11px;
			color: #4a5568;
			margin: 0 2px;
		}
		
		/* å“åº”å¼ */
		@media (max-width: 768px) {
			.shares-main-card {
				padding: 24px 16px;
				margin: 10px;
				border-radius: 20px;
			}
			
			.shares-header-icon { font-size: 36px; }
			.shares-header-title { font-size: 24px; }
			
			.shares-grid {
				grid-template-columns: 1fr;
				gap: 16px;
			}
			
			.shares-filters { gap: 8px; }
			.filter-tag { padding: 8px 14px; font-size: 13px; }
			
			.detail-panel {
				width: 100%;
			}
			
			.panel-tips {
				display: none;
			}
		}
	</style>
</head>

<body>
	<header>
		<nav class="navbar navbar-expand-lg navbar-dark fixed-top shares-navbar">
			<a class="navbar-brand" target="_blank" href="https://github.com/2015winter/QZoneExporter">
				<i class="fa fa-cloud-download mr-2"></i>QQç©ºé—´å¯¼å‡ºåŠ©æ‰‹
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb shares-breadcrumb">
						<li class="breadcrumb-item"><a href="../index.html"><i class="fa fa-home mr-1"></i>ä¸ªäººä¸­å¿ƒ</a></li>
						<li class="breadcrumb-item active" aria-current="page"><i class="fa fa-share-alt mr-1"></i>åˆ†äº«</li>
					</ol>
				</nav>
			</div>
		</nav>
	</header>
	
	<main role="main" class="flex-shrink-0" style="padding: 20px;">
		<div class="shares-main-card">
			<!-- é¡µé¢æ ‡é¢˜ -->
			<div class="shares-header">
				<i class="fa fa-share-alt shares-header-icon"></i>
				<h1 class="shares-header-title">æˆ‘çš„åˆ†äº«</h1>
				<p class="shares-header-subtitle">å…± <span class="shares-total-count" id="shares-count"><%:=total%></span> æ¡åˆ†äº«ï¼Œè®°å½•äº†é‚£äº›å€¼å¾—åˆ†äº«çš„ç¬é—´</p>
			</div>
			
			<!-- ç­›é€‰æ ‡ç­¾ - ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
			<div class="shares-filters" id="shares-filters"></div>
			
			<!-- åˆ†äº«ç½‘æ ¼ -->
			<div class="shares-grid" id="shares-grid">
					<%for (let index = 0; index < sharesList.length; index++) {%>
					<%const share = sharesList[index]%>
					<%const picsumSeed = share.id || Date.now()%>
					<%const sourceImages = share.source && share.source.images || []%>
					<%const firstImage = sourceImages[0] || {}%>
					<%const coverUrl = firstImage.custom_filepath || firstImage.custom_url || firstImage.url || ''%>
					<%const shareTitle = (share.source && share.source.title) ? share.source.title : 'åˆ†äº«å†…å®¹'%>
					<%const shareDesc = share.desc || (share.source && share.source.desc) || 'æš‚æ— è¯¦ç»†æè¿°'%>
					<%const sourceFrom = (share.source && share.source.from && share.source.from.name) || ''%>
					<%const shareTypeName = API.Shares.getDisplayType(share.type)%>
					<div class="share-card" data-index="<%:=index%>" data-id="<%:=share.id%>" data-type="<%:=shareTypeName%>">
						<img class="share-card-cover lazyload" src="<%:=coverUrl || ('https://picsum.photos/seed/' + picsumSeed + '/400/300')%>" alt="å°é¢" onerror="this.onerror=null;this.src='https://picsum.photos/seed/<%:=picsumSeed%>/400/300'">
						<div class="share-card-content">
							<span class="share-card-type"><%:=API.Shares.getDisplayType(share.type)%></span>
							<h3 class="share-card-title"><%:=API.Common.formatContent(shareTitle, 'HTML', false, false, false, false, true)%></h3>
							<p class="share-card-summary"><%:=API.Common.formatContent(shareDesc, 'HTML', false, false, false, false, true)%></p>
							<div class="share-card-meta">
								<span class="share-card-source"><%if(sourceFrom){%><span>ğŸ“</span> <%:=sourceFrom%><%}%></span>
								<span><%:=API.Utils.formatDate(share.shareTime)%></span>
							</div>
							<div class="share-card-meta" style="margin-top: 8px;">
								<span></span>
								<div class="share-card-actions">
									<span>ğŸ‘ <%:=share.likeTotal || 0%></span>
									<span>ğŸ’¬ <%:=share.comments ? share.comments.length : 0%></span>
								</div>
							</div>
						</div>
					</div>
				<%}%>
			</div>
			
			<!-- ç©ºçŠ¶æ€ -->
			<div class="shares-empty" id="shares-empty">
				<i class="fa fa-share-alt"></i>
				<p>æš‚æ— åˆ†äº«å†…å®¹</p>
			</div>
		</div>
	</main>
	
	<!-- ä¾§è¾¹è¯¦æƒ…é¢æ¿ -->
	<div class="detail-overlay" id="detail-overlay"></div>
	<div class="detail-panel" id="detail-panel">
		<div class="panel-header">
			<div class="panel-nav">
				<button class="panel-nav-btn" id="btn-prev" title="ä¸Šä¸€æ¡ (â†)"><i class="fa fa-chevron-left"></i></button>
				<span class="panel-counter"><span id="current-index">1</span> / <span id="total-count">0</span></span>
				<button class="panel-nav-btn" id="btn-next" title="ä¸‹ä¸€æ¡ (â†’)"><i class="fa fa-chevron-right"></i></button>
			</div>
			<button class="panel-close" id="btn-close" title="å…³é—­ (Esc)"><i class="fa fa-times"></i></button>
		</div>
		<div class="panel-body" id="panel-body">
			<!-- åŠ¨æ€å†…å®¹ -->
		</div>
		<div class="panel-tips">
			<kbd>â†</kbd> ä¸Šä¸€æ¡ &nbsp;&nbsp; <kbd>â†’</kbd> ä¸‹ä¸€æ¡ &nbsp;&nbsp; <kbd>Esc</kbd> å…³é—­
		</div>
	</div>
	
	<!-- åº•éƒ¨ -->
	<footer class="shares-footer">
		<span class="footer-text">
			<i class="fa fa-share-alt"></i> åˆ†äº«ç¾å¥½ï¼Œè®°å½•ç²¾å½©
		</span>
	</footer>
	
	<script>
		// å½“å‰ç­›é€‰ç±»å‹
		var currentFilter = 'all';
		// å½“å‰é€‰ä¸­çš„å¡ç‰‡ç´¢å¼•
		var currentIndex = -1;
		// é¢æ¿æ˜¯å¦æ‰“å¼€
		var isPanelOpen = false;
		
		// åˆ†äº«ç±»å‹é…ç½®ï¼ˆå”¯ä¸€ç»´æŠ¤ç‚¹ï¼‰
		var shareTypeConfig = [
			{type: 'æ—¥å¿—', icon: 'ğŸ“'},
			{type: 'ç›¸å†Œ', icon: 'ğŸ“š'},
			{type: 'ç…§ç‰‡', icon: 'ğŸ–¼ï¸'},
			{type: 'ç½‘é¡µ', icon: 'ğŸŒ'},
			{type: 'è§†é¢‘', icon: 'ğŸ¬'},
			{type: 'å•†å“', icon: 'ğŸ›’'},
			{type: 'æ–°é—»', icon: 'ğŸ“°'},
			{type: 'å¾®åš', icon: 'ğŸ’¬'},
			{type: 'éŸ³ä¹', icon: 'ğŸµ'},
			{type: 'å…¶å®ƒ', icon: 'ğŸ“'}
		];
		
		// åˆå§‹åŒ–é¡µé¢
		function init() {
			renderFilters();
			bindEvents();
		}
		
		// æ¸²æŸ“ç­›é€‰æ ‡ç­¾
		function renderFilters() {
			if (typeof shares === 'undefined' || !Array.isArray(shares)) return;
			
			// ç»Ÿè®¡å„ç±»å‹æ•°é‡
			var typeCounts = {};
			for (var i = 0; i < shares.length; i++) {
				var typeName = API.Shares.getDisplayType(shares[i].type);
				typeCounts[typeName] = (typeCounts[typeName] || 0) + 1;
			}
			
			// ç”ŸæˆæŒ‰é’®HTML
			var html = '<button class="filter-tag active" data-type="all">å…¨éƒ¨ <span class="count">' + shares.length + '</span></button>';
			for (var i = 0; i < shareTypeConfig.length; i++) {
				var config = shareTypeConfig[i];
				var count = typeCounts[config.type] || 0;
				html += '<button class="filter-tag" data-type="' + config.type + '">' + config.icon + ' ' + config.type + ' <span class="count">' + count + '</span></button>';
			}
			
			$('#shares-filters').html(html);
		}
		
		// æ‰“å¼€ä¾§è¾¹é¢æ¿
		function openPanel(index) {
			if (typeof shares === 'undefined' || !Array.isArray(shares)) return;
			if (index < 0 || index >= shares.length) return;
			
			currentIndex = index;
			isPanelOpen = true;
			
			// æ›´æ–°å¡ç‰‡é€‰ä¸­çŠ¶æ€
			$('.share-card').removeClass('active');
			$('.share-card[data-index="' + index + '"]').addClass('active');
			
			// æ˜¾ç¤ºé®ç½©å’Œé¢æ¿
			$('#detail-overlay').addClass('show');
			$('#detail-panel').addClass('show');
			
			// ç¦æ­¢bodyæ»šåŠ¨
			$('body').css('overflow', 'hidden');
			
			// æ¸²æŸ“è¯¦æƒ…å†…å®¹
			renderPanelContent(index);
			
			// æ›´æ–°å¯¼èˆªçŠ¶æ€
			updateNavState();
		}
		
		// å…³é—­ä¾§è¾¹é¢æ¿
		function closePanel() {
			isPanelOpen = false;
			currentIndex = -1;
			
			// ç§»é™¤å¡ç‰‡é€‰ä¸­çŠ¶æ€
			$('.share-card').removeClass('active');
			
			// éšè—é®ç½©å’Œé¢æ¿
			$('#detail-overlay').removeClass('show');
			$('#detail-panel').removeClass('show');
			
			// æ¢å¤bodyæ»šåŠ¨
			$('body').css('overflow', '');
			
			// æ¸…ç©ºé¢æ¿å†…å®¹
			$('#panel-body').html('');
		}
		
		// æ¸²æŸ“é¢æ¿å†…å®¹ - ä¿ç•™åŸåˆ†äº«å†…å®¹æ ·å¼
		function renderPanelContent(index) {
			var share = shares[index];
			if (!share) return;
			
			var html = '';
			
			// è¯¦æƒ…å¤´éƒ¨ - ç”¨æˆ·ä¿¡æ¯
			html += '<div class="detail-header">';
			html += '<div class="detail-user">';
			html += '<a target="_blank" href="' + API.Common.getUserUrl(share.uin) + '">';
			html += '<img class="detail-avatar" src="' + API.Common.getUserLogoLocalUrl(share.uin, true) + '" alt="å¤´åƒ">';
			html += '</a>';
			html += '<div class="detail-user-info">';
			html += '<div class="detail-user-name"><a target="_blank" href="' + API.Common.getUserUrl(share.uin) + '">' + API.Common.formatContent(share.nickname, 'HTML', false, false, false, false, true) + '</a></div>';
			html += '<div class="detail-time">' + API.Utils.formatDate(share.shareTime) + '</div>';
			html += '</div>';
			html += '<span class="detail-type">' + API.Shares.getDisplayType(share.type) + '</span>';
			html += '</div>';
			html += '</div>';
			
			// åˆ†äº«æè¿°
			if (share.desc) {
				html += '<div class="detail-desc">' + API.Common.formatContent(share.desc, 'HTML', false, false, false, false, true) + '</div>';
			}
			
			// åˆ†äº«æ¥æºå†…å®¹ï¼ˆå°é¢å›¾å·²åœ¨å¡ç‰‡ä¸Šæ˜¾ç¤ºï¼Œè¯¦æƒ…é¢æ¿åªæ˜¾ç¤ºæ ‡é¢˜ã€æè¿°ç­‰æ–‡å­—ä¿¡æ¯ï¼‰
			if (share.source) {
				var sourceImages = share.source.images || [];
				var sourceUrl = share.source.url || '';
				
				html += '<div class="detail-source" onclick="' + (sourceUrl ? "window.open('" + sourceUrl + "', '_blank')" : '') + '">';
				
				if (share.source.title) {
					html += '<h3 class="detail-source-title"><a target="_blank" href="' + sourceUrl + '">' + API.Common.formatContent(share.source.title, 'HTML', false, false, false, false, true) + '</a></h3>';
				}
				if (share.source.desc) {
					html += '<p class="detail-source-summary">' + API.Common.formatContent(share.source.desc, 'HTML', false, false, false, false, true) + '</p>';
				}
				if (share.source.from && share.source.from.name) {
					html += '<div class="detail-source-from">æ¥è‡ª ' + share.source.from.name + '</div>';
				}
				html += '</div>';
				
				// æ‰€æœ‰å›¾ç‰‡ï¼ˆä¸å†è·³è¿‡ç¬¬ä¸€å¼ ï¼Œå› ä¸ºå°é¢å›¾å·²åœ¨å¡ç‰‡ä¸Šå•ç‹¬æ˜¾ç¤ºï¼‰
				// åªæ˜¾ç¤ºæœ‰æ•ˆçš„å›¾ç‰‡ï¼ˆæ·»åŠ  onerror å¤„ç†æ¥éšè—åŠ è½½å¤±è´¥çš„å›¾ç‰‡ï¼‰
				if (sourceImages.length > 0) {
					var hasValidImage = false;
					var mediasHtml = '';
					for (var i = 0; i < sourceImages.length; i++) {
						var img = sourceImages[i];
						var imgUrl = img.custom_filepath || img.custom_url || img.url || '';
						if (imgUrl) {
							hasValidImage = true;
							mediasHtml += '<a class="medias-item" data-src="' + imgUrl + '"><img src="' + imgUrl + '" alt="" onerror="this.parentElement.style.display=\'none\'"></a>';
						}
					}
					if (hasValidImage) {
						html += '<div class="detail-medias" id="detail-medias-' + share.id + '">' + mediasHtml + '</div>';
					}
				}
			} else {
				// æ— æ¥æºå†…å®¹æ—¶ï¼Œæ˜¾ç¤ºç®€å•è¯´æ˜
				html += '<div class="detail-source">';
				html += '<h3 class="detail-source-title">åˆ†äº«å†…å®¹</h3>';
				html += '<p class="detail-source-summary">æš‚æ— è¯¦ç»†æè¿°</p>';
				html += '</div>';
			}
			
			// ç»Ÿè®¡ä¿¡æ¯
			var floorNum = shares.length - index;
			html += '<div class="detail-stats">';
			html += '<span class="detail-floor">#' + floorNum + '</span>';
			html += '<div class="detail-actions">';
			html += '<span class="detail-action-item viewlikes" title="ç‚¹èµåˆ—è¡¨" data-field="id" data-target="' + share.id + '"><i class="fa fa-thumbs-up"></i> ' + (share.likeTotal || 0) + '</span>';
			html += '<span class="detail-action-item viewVisitors" title="æœ€è¿‘è®¿é—®" data-field="id" data-target="' + share.id + '"><i class="fa fa-eye"></i> ' + (share.custom_visitor && share.custom_visitor.viewCount || 0) + '</span>';
			html += '<span class="detail-action-item"><i class="fa fa-comment"></i> ' + (share.comments ? share.comments.length : 0) + '</span>';
			html += '</div>';
			html += '</div>';
			
			// è¯„è®ºåŒº
			if (share.comments && share.comments.length > 0) {
				html += '<div class="detail-comments">';
				html += '<div class="detail-comments-title">ğŸ’¬ è¯„è®º (' + share.comments.length + ')</div>';
				
				for (var j = 0; j < share.comments.length; j++) {
					var comment = share.comments[j];
					var commentUser = API.Common.getCommentUser(comment);
					
					html += '<div class="detail-comment-item">';
					html += '<a target="_blank" href="' + API.Common.getUserUrl(commentUser.uin) + '">';
					html += '<img class="detail-comment-avatar" src="' + API.Common.getUserLogoLocalUrl(commentUser.uin, true) + '" alt="å¤´åƒ">';
					html += '</a>';
					html += '<div class="detail-comment-body">';
					html += '<div class="detail-comment-user">';
					html += '<a target="_blank" href="' + API.Common.getUserUrl(commentUser.uin) + '">' + API.Common.formatContent(commentUser.name, 'HTML', false, false, false, false, true) + '</a>';
					if (comment.private) {
						html += '<span class="private-tag">ç§å¯†è¯„è®º</span>';
					}
					html += '</div>';
					html += '<div class="detail-comment-text">' + API.Common.formatContent(comment.content, 'HTML', false, false, false, false, true) + '</div>';
					
					// è¯„è®ºå›¾ç‰‡
					if (comment.pic && comment.pic.length > 0) {
						html += '<div class="detail-comment-images">';
						for (var k = 0; k < comment.pic.length; k++) {
							var pic = comment.pic[k];
							var picUrl = pic.custom_filepath || pic.custom_url || pic.o_url || pic.hd_url || pic.b_url || pic.s_url || pic.url;
							html += '<img src="' + picUrl + '" alt="" onclick="window.open(\'' + picUrl + '\', \'_blank\')">';
						}
						html += '</div>';
					}
					
					html += '<div class="detail-comment-time">' + API.Utils.formatDate(comment.postTime || comment.create_time) + '</div>';
					
					// å›å¤
					if (comment.replies && comment.replies.length > 0) {
						for (var m = 0; m < comment.replies.length; m++) {
							var reply = comment.replies[m];
							var replyUser = API.Common.getCommentUser(reply);
							
							html += '<div class="detail-reply-item">';
							html += '<div class="detail-comment-user">';
							html += '<a target="_blank" href="' + API.Common.getUserUrl(replyUser.uin) + '">' + API.Common.formatContent(replyUser.name, 'HTML', false, false, false, false, true) + '</a>';
							if (reply.private) {
								html += '<span class="private-tag">ç§å¯†å›å¤</span>';
							}
							html += '</div>';
							html += '<div class="detail-comment-text">' + API.Common.formatContent(reply.content, 'HTML', false, false, false, false, true) + '</div>';
							
							// å›å¤å›¾ç‰‡
							if (reply.pic && reply.pic.length > 0) {
								html += '<div class="detail-comment-images">';
								for (var n = 0; n < reply.pic.length; n++) {
									var rPic = reply.pic[n];
									var rPicUrl = rPic.custom_filepath || rPic.custom_url || rPic.o_url || rPic.hd_url || rPic.b_url || rPic.s_url || rPic.url;
									html += '<img src="' + rPicUrl + '" alt="" onclick="window.open(\'' + rPicUrl + '\', \'_blank\')">';
								}
								html += '</div>';
							}
							
							html += '<div class="detail-comment-time">' + API.Utils.formatDate(reply.postTime || reply.create_time) + '</div>';
							html += '</div>';
						}
					}
					
					html += '</div>';
					html += '</div>';
				}
				
				html += '</div>';
			}
			
			// å¡«å……é¢æ¿å†…å®¹
			$('#panel-body').html(html);
			
			// æ»šåŠ¨åˆ°é¡¶éƒ¨
			$('#panel-body').scrollTop(0);
			
			// åˆå§‹åŒ–è¯¦æƒ…ä¸­çš„å›¾ç‰‡ç”»å»Š
			var mediasEl = document.getElementById('detail-medias-' + share.id);
			if (mediasEl && $(mediasEl).find('.medias-item').length > 0) {
				lightGallery(mediasEl, {
					selector: '.medias-item',
					plugins: [lgZoom, lgThumbnail, lgFullscreen, lgRotate],
					speed: 300,
					thumbnail: true,
					download: false
				});
			}
		}
		
		// æ›´æ–°å¯¼èˆªçŠ¶æ€
		function updateNavState() {
			var total = shares.length;
			
			$('#current-index').text(currentIndex + 1);
			$('#total-count').text(total);
			
			// æ›´æ–°æŒ‰é’®çŠ¶æ€
			$('#btn-prev').prop('disabled', currentIndex <= 0);
			$('#btn-next').prop('disabled', currentIndex >= total - 1);
		}
		
		// ä¸Šä¸€æ¡
		function goPrev() {
			if (currentIndex > 0) {
				openPanel(currentIndex - 1);
			}
		}
		
		// ä¸‹ä¸€æ¡
		function goNext() {
			if (currentIndex < shares.length - 1) {
				openPanel(currentIndex + 1);
			}
		}
		
		// ç»‘å®šäº‹ä»¶
		function bindEvents() {
			// ç­›é€‰æ ‡ç­¾ç‚¹å‡»
			$('.filter-tag').on('click', function() {
				$('.filter-tag').removeClass('active');
				$(this).addClass('active');
				currentFilter = $(this).data('type');
				filterShares();
			});
			
			// å¡ç‰‡ç‚¹å‡» - æ‰“å¼€ä¾§è¾¹é¢æ¿
			$('#shares-grid').on('click', '.share-card', function(e) {
				var index = parseInt($(this).data('index'));
				openPanel(index);
			});
			
			// å…³é—­æŒ‰é’®ç‚¹å‡»
			$('#btn-close').on('click', closePanel);
			
			// é®ç½©ç‚¹å‡»å…³é—­
			$('#detail-overlay').on('click', closePanel);
			
			// ä¸Šä¸€æ¡/ä¸‹ä¸€æ¡æŒ‰é’®
			$('#btn-prev').on('click', goPrev);
			$('#btn-next').on('click', goNext);
			
			// é”®ç›˜äº‹ä»¶
			$(document).on('keydown', function(e) {
				if (!isPanelOpen) return;
				
				if (e.key === 'Escape') {
					closePanel();
					e.preventDefault();
				} else if (e.key === 'ArrowLeft') {
					goPrev();
					e.preventDefault();
				} else if (e.key === 'ArrowRight') {
					goNext();
					e.preventDefault();
				}
			});
			
			// é˜»æ­¢é¢æ¿å†…ç‚¹å‡»äº‹ä»¶å†’æ³¡åˆ°é®ç½©
			$('#detail-panel').on('click', function(e) {
				e.stopPropagation();
			});
		}
		
		// ç­›é€‰åˆ†äº«
		function filterShares() {
			var $cards = $('.share-card');
			var visibleCount = 0;
			
			$cards.each(function() {
				var cardType = $(this).data('type');
				if (currentFilter === 'all' || cardType === currentFilter) {
					$(this).show();
					visibleCount++;
				} else {
					$(this).hide();
				}
			});
			
			// æ›´æ–°æ˜¾ç¤ºæ•°é‡
			$('#shares-count').text(visibleCount);
			
			// æ˜¾ç¤º/éšè—ç©ºçŠ¶æ€
			if (visibleCount === 0) {
				$('#shares-empty').show();
			} else {
				$('#shares-empty').hide();
			}
		}
		
		// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
		$(document).ready(function() {
			init();
		});
	</script>
</body>

</html>