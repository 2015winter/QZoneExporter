<!DOCTYPE html>
<html lang="zh">

<head>
	<link rel="icon" href="../Common/images/favicon.ico"> 
	<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>QQ空间备份-相册</title>
	<link rel="stylesheet" href="../Common/vendor/css/font-awesome.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../Common/css/common.css">
	<script src="../Common/vendor/js/jquery.min.js"></script>
	<script src="../Common/vendor/js/bootstrap.bundle.min.js"></script>
	<script src="../Common/vendor/js/lodash.min.js"></script>
	<script src="../Common/vendor/js/clicklove.min.js"></script>
	
	<script type="text/javascript" src="../Common/json/config.js"></script>
	<script type="text/javascript" src="json/albums.js"></script>
	<script type="text/javascript" src="../Common/js/common.js"></script>
	<script type="text/javascript" src="js/albums.js"></script>
	
	<style>
		body {
			background: linear-gradient(135deg, #11998e 0%, #38ef7d 50%, #96fbc4 100%);
			min-height: 100vh;
			padding-top: 70px;
			padding-bottom: 80px;
		}
		
		.navbar-albums {
			background: linear-gradient(135deg, rgba(17, 153, 142, 0.95), rgba(56, 239, 125, 0.95)) !important;
			backdrop-filter: blur(10px);
		}
		
		.main-card {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(20px);
			border-radius: 24px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
			padding: 40px;
			margin-top: 20px;
		}
		
		.page-header {
			text-align: center;
			margin-bottom: 40px;
			padding-bottom: 30px;
			border-bottom: 1px solid rgba(0, 0, 0, 0.08);
		}
		
		.page-header-icon {
			font-size: 48px;
			background: linear-gradient(135deg, #11998e, #38ef7d);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			margin-bottom: 16px;
		}
		
		.page-header-title {
			font-size: 32px;
			font-weight: 700;
			background: linear-gradient(135deg, #11998e, #38ef7d);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
		}
		
		.page-stats {
			color: #718096;
			margin-top: 12px;
		}
		
		/* 分类标签 - 显示在卡片内 */
		.category-badge {
			display: inline-block;
			background: linear-gradient(135deg, rgba(17, 153, 142, 0.1), rgba(56, 239, 125, 0.1));
			color: #11998e;
			padding: 4px 12px;
			border-radius: 20px;
			font-size: 12px;
			margin-bottom: 8px;
		}
		
		/* 相册网格 */
		.albums-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
			gap: 24px;
		}
		
		.album-card {
			background: #fff;
			border-radius: 16px;
			overflow: hidden;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
			cursor: pointer;
			transition: all 0.3s ease;
			text-decoration: none;
			color: inherit;
			display: block;
		}
		
		.album-card:hover {
			transform: translateY(-8px);
			box-shadow: 0 12px 30px rgba(17, 153, 142, 0.25);
			text-decoration: none;
			color: inherit;
		}
		
		.album-cover {
			position: relative;
			height: 200px;
			overflow: hidden;
		}
		
		.album-cover img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			transition: transform 0.3s ease;
		}
		
		.album-card:hover .album-cover img {
			transform: scale(1.1);
		}
		
		.album-count {
			position: absolute;
			top: 10px;
			right: 10px;
			background: linear-gradient(135deg, #11998e, #38ef7d);
			color: #fff;
			padding: 4px 12px;
			border-radius: 20px;
			font-size: 13px;
			font-weight: 600;
		}
		
		.album-info {
			padding: 20px;
		}
		
		.album-name {
			font-size: 18px;
			font-weight: 600;
			color: #333;
			margin-bottom: 8px;
		}
		
		.album-desc {
			font-size: 14px;
			color: #666;
			line-height: 1.5;
			display: -webkit-box;
			-webkit-line-clamp: 2;
			-webkit-box-orient: vertical;
			overflow: hidden;
			min-height: 42px;
		}
		
		.album-stats {
			margin-top: 12px;
			font-size: 13px;
			color: #999;
		}
		
		.album-stats span {
			margin-right: 15px;
		}
		
		.footer-albums {
			background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9));
		}
		
		/* 响应式 */
		@media (max-width: 768px) {
			.main-card {
				padding: 20px;
			}
			
			.page-header-title {
				font-size: 24px;
			}
			
			.albums-grid {
				grid-template-columns: repeat(2, 1fr);
				gap: 12px;
			}
			
			.album-cover {
				height: 150px;
			}
			
			.album-info {
				padding: 12px;
			}
			
			.album-name {
				font-size: 14px;
			}
			
			.album-desc {
				font-size: 12px;
			}
		}
	</style>
</head>

<body>
	<header>
		<nav class="navbar navbar-expand-lg navbar-dark fixed-top navbar-albums">
			<a class="navbar-brand" href="../index.html">
				<i class="fa fa-cloud-download mr-2"></i>QQ空间导出助手
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb" style="background: transparent;">
						<li class="breadcrumb-item"><a href="../index.html" style="color: rgba(255,255,255,0.85);"><i class="fa fa-home mr-1"></i>个人中心</a></li>
						<li class="breadcrumb-item active" style="color: rgba(255,255,255,0.9);"><i class="fa fa-picture-o mr-1"></i>相册</li>
					</ol>
				</nav>
			</div>
		</nav>
	</header>
	
	<main role="main" class="flex-shrink-0">
		<div class="container">
			<div class="main-card">
				<div class="page-header">
					<i class="fa fa-picture-o page-header-icon"></i>
					<h1 class="page-header-title">我的相册</h1>
					<div class="page-stats">
						共 <span id="totalAlbumsCount"></span> 个相册，<span id="totalPhotosCount"></span> 张照片
					</div>
				</div>
				
				<!-- 相册网格 - 所有相册平铺展示 -->
				<div class="albums-grid" id="albums_container">
					<%/* 遍历所有相册 */%>
					<%for (const [className, items] of albumsMapping) {%>
						<%for (const album of items) {%>
						<a class="album-card" href="<%:=API.Utils.filenameValidate(album.name)%>.html" <%if (album.allowAccess <= 0 || !album.photoList || album.photoList.length === 0) {%>onclick="return false;" style="opacity: 0.6; cursor: not-allowed;"<%}%>>
							<div class="album-cover">
								<img src="<%:=(album.custom_filepath || album.custom_url || album.url || album.pre)%>" alt="<%:=album.name%>" loading="lazy">
								<span class="album-count"><i class="fa fa-image mr-1"></i><%:=album.total%></span>
							</div>
							<div class="album-info" data-toggle="tooltip" data-html="true" title="<%:=API.Photos.getAlbumBasicInfoTooltip(album)%>">
								<span class="category-badge"><%:=className%></span>
								<h3 class="album-name"><%:=API.Utils.formatContent(album.name, "HTML", false, false, false, false, true)%></h3>
								<p class="album-desc"><%:=album.desc || '暂无描述'%></p>
								<div class="album-stats">
									<span><i class="fa fa-heart text-danger"></i> <%:=album.likes ? album.likes.length : 0%></span>
									<span><i class="fa fa-comment text-info"></i> <%:=album.comments ? album.comments.length : 0%></span>
									<span><i class="fa fa-eye text-warning"></i> <%:=album.custom_visitor ? album.custom_visitor.viewCount : 0%></span>
								</div>
							</div>
						</a>
						<%}%>
					<%}%>
				</div>
			</div>
		</div>
	</main>
	
	<footer class="footer mt-auto py-3 fixed-bottom footer-albums">
		<div class="container text-center">
			<span class="text-white">
				<i class="fa fa-leaf mr-2"></i>落叶随风，青春，稀纵即逝
			</span>
		</div>
	</footer>
	
	<script>
		$(function() {
			// 计算总相册数和总照片数
			let totalAlbums = 0;
			let totalPhotos = 0;
			if (typeof albums !== 'undefined' && albums) {
				totalAlbums = albums.length;
				albums.forEach(album => {
					totalPhotos += album.photoList?.length || 0;
				});
			}
			$('#totalAlbumsCount').text(totalAlbums);
			$('#totalPhotosCount').text(totalPhotos);
			
			// 初始化提示
			$('[data-toggle="tooltip"]').tooltip({
				placement: 'auto',
				container: 'body',
				boundary: 'window'
			});
		});
	</script>
</body>

</html>
