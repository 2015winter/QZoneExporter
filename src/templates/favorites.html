<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<link rel="icon" href="../Common/images/favicon.ico">
	<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>QQç©ºé—´å¤‡ä»½-æ”¶è—</title>
	<link rel="stylesheet" href="../Common/vendor/css/font-awesome.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/bootstrap.min.css">
	
	<link rel="stylesheet" href="../Common/vendor/css/lightgallery.min.css">
	<link rel="stylesheet" href="../Common/vendor/css/lightgallery-bundle.min.css">
	
	<link rel="stylesheet" type="text/css" href="../Common/css/common.css">
	<script src="../Common/vendor/js/jquery.min.js"></script>
	<script src="../Common/vendor/js/jquery.mousewheel.min.js"></script>
	<script src="../Common/vendor/js/bootstrap.bundle.min.js"></script>
	<script src="../Common/vendor/js/lodash.min.js"></script>
	
	<script src="../Common/vendor/js/lightgallery.min.js"></script>
	<script src="../Common/vendor/js/lg-zoom.min.js"></script>
	<script src="../Common/vendor/js/lg-video.min.js"></script>
	<script src="../Common/vendor/js/lg-thumbnail.min.js"></script>
	<script src="../Common/vendor/js/lg-rotate.min.js"></script>
	<script src="../Common/vendor/js/lg-fullscreen.min.js"></script>
	<script src="../Common/vendor/js/lg-autoplay.min.js"></script>

	<script src="../Common/vendor/js/lazyload.min.js"></script>
	<script src="../Common/vendor/js/index.aio.min.js"></script>
	<script src="../Common/vendor/js/clicklove.min.js"></script>
	
	<script type="text/javascript" src="../Common/json/config.js"></script>
	<script type="text/javascript" src="../Common/js/common.js"></script>
	<script type="text/javascript" src="json/favorites.js"></script>
	
	<script>
	// æ”¶è—ç±»å‹ç›¸å…³è¾…åŠ©å‡½æ•°
	var FavoritesHelper = {
		// è·å–æ”¶è—ç±»å‹åç§°
		getType: function(type) {
			var typeMap = { 3: 'æ—¥å¿—', 5: 'è¯´è¯´', 7: 'åˆ†äº«' };
			return typeMap[type] || 'å…¶ä»–';
		},
		// è·å–æ”¶è—ç±»å‹é”®å€¼ï¼ˆæ ¹æ®æ”¶è—å†…å®¹åˆ¤æ–­ï¼‰
		// ä¼˜å…ˆæŒ‰å†…å®¹ç±»å‹åˆ¤æ–­ï¼šéŸ³ä¹ > è§†é¢‘ > å›¾ç‰‡ > æ–‡ç« 
		getTypeKey: function(favorite) {
			if (typeof favorite === 'number') return 'article';
			// ä¼˜å…ˆåˆ¤æ–­æ˜¯å¦æœ‰éŸ³ä¹
			if (favorite.custom_audios && favorite.custom_audios.length > 0) return 'music';
			// ç„¶ååˆ¤æ–­æ˜¯å¦æœ‰è§†é¢‘
			if (favorite.custom_videos && favorite.custom_videos.length > 0) return 'video';
			// åˆ¤æ–­æ˜¯å¦çº¯å›¾ç‰‡å†…å®¹ï¼ˆæœ‰å›¾ç‰‡ä½†æ²¡æœ‰æ–‡å­—å†…å®¹æˆ–æ ‡é¢˜å¾ˆçŸ­ï¼‰
			var hasImages = (favorite.custom_origin_images && favorite.custom_origin_images.length > 0) || 
				(favorite.custom_images && favorite.custom_images.length > 0);
			if (hasImages) {
				// æ£€æŸ¥æ˜¯å¦æœ‰å®è´¨æ–‡å­—å†…å®¹
				var hasText = (favorite.title && favorite.title.trim().length > 10) ||
					(favorite.abstract && favorite.abstract.trim().length > 20) ||
					(favorite.desp && favorite.desp.trim().length > 20);
				// å¦‚æœæ²¡æœ‰å®è´¨æ–‡å­—ï¼Œå½’ç±»ä¸ºå›¾ç‰‡
				if (!hasText) return 'photo';
			}
			// é»˜è®¤ä¸ºæ–‡ç« ç±»å‹ï¼ˆè¯´è¯´/æ—¥å¿—/åˆ†äº«ï¼‰
			return 'article';
		},
		// è·å–æ”¶è—ç±»å‹ä¿¡æ¯
		getTypeInfo: function(type) {
			var typeInfoMap = {
				3: { name: 'æ—¥å¿—', icon: 'ğŸ“„', color: '#4A90E2' },
				5: { name: 'è¯´è¯´', icon: 'ğŸ’¬', color: '#E24A90' },
				7: { name: 'åˆ†äº«', icon: 'ğŸ”—', color: '#E2904A' }
			};
			return typeInfoMap[type] || { name: 'å…¶ä»–', icon: 'ğŸ“Œ', color: '#999' };
		},
		// è·å–æ”¶è—çš„åŸä½œè€…ä¿¡æ¯
		getFavoriteOwner: function(favorite) {
			if (favorite.shuoshuo_info) {
				return { name: favorite.shuoshuo_info.owner_name || 'æœªçŸ¥', uin: favorite.shuoshuo_info.owner_uin };
			} else if (favorite.share_info) {
				return { name: favorite.share_info.owner_name || 'æœªçŸ¥', uin: favorite.share_info.owner_uin };
			} else if (favorite.blog_info) {
				return { name: favorite.blog_info.owner_name || 'æœªçŸ¥', uin: favorite.blog_info.owner_uin };
			}
			return { name: favorite.custom_name || 'æœªçŸ¥', uin: favorite.custom_uin || '' };
		},
		// HTMLè½¬ä¹‰
		escapeHtml: function(text) {
			if (!text) return '';
			var div = document.createElement('div');
			div.textContent = text;
			return div.innerHTML;
		},
		// è·å–å®Œæ•´å†…å®¹æ–‡æœ¬
		getFullContent: function(favorite) {
			var content = '';
			// ä¼˜å…ˆä½¿ç”¨è¯´è¯´å†…å®¹
			if (favorite.shuoshuo_info && favorite.shuoshuo_info.detail_shuoshuo_info && favorite.shuoshuo_info.detail_shuoshuo_info.content) {
				content = favorite.shuoshuo_info.detail_shuoshuo_info.content;
			} else if (favorite.abstract) {
				content = favorite.abstract;
			} else if (favorite.desp) {
				content = favorite.desp;
			}
			return content || 'æš‚æ— å†…å®¹';
		},
		// è·å–æ”¶è—ç†ç”±
		getReason: function(favorite) {
			if (favorite.shuoshuo_info && favorite.shuoshuo_info.reason) {
				return favorite.shuoshuo_info.reason;
			} else if (favorite.share_info && favorite.share_info.reason) {
				return favorite.share_info.reason;
			} else if (favorite.blog_info && favorite.blog_info.reason) {
				return favorite.blog_info.reason;
			}
			return '';
		}
	};
	</script>
	
	<style>
		/* æ”¶è—é¡µé¢ä¸“å±æ ·å¼ - ä¿ç•™é»„æ©™è‰²ä¸»é¢˜ */
		body.favorites-page {
			background: linear-gradient(135deg, #feca57 0%, #ff9f43 50%, #f093fb 100%);
			min-height: 100vh;
			padding-top: 70px;
			padding-bottom: 80px;
		}
		
		/* å¯¼èˆªæ æ ·å¼ */
		.favorites-navbar {
			background: linear-gradient(135deg, rgba(254, 202, 87, 0.95), rgba(255, 159, 67, 0.95)) !important;
			backdrop-filter: blur(10px);
		}
		
		.favorites-breadcrumb {
			background: transparent !important;
		}
		
		.favorites-breadcrumb .breadcrumb-item a {
			color: rgba(255, 255, 255, 0.85);
			transition: color 0.3s ease;
		}
		
		.favorites-breadcrumb .breadcrumb-item a:hover {
			color: #fff;
			text-decoration: none;
		}
		
		.favorites-breadcrumb .breadcrumb-item.active {
			color: rgba(255, 255, 255, 0.9);
		}
		
		.favorites-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
			color: rgba(255, 255, 255, 0.5);
		}
		
		/* ä¸»å¡ç‰‡å®¹å™¨ */
		.favorites-main-card {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(20px);
			border-radius: 24px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
			padding: 40px;
			margin-top: 20px;
			margin-left: auto;
			margin-right: auto;
			max-width: 1200px;
			animation: fadeInUp 0.6s ease-out;
		}
		
		@keyframes fadeInUp {
			from { opacity: 0; transform: translateY(30px); }
			to { opacity: 1; transform: translateY(0); }
		}
		
		/* é¡µé¢æ ‡é¢˜åŒºåŸŸ */
		.favorites-header {
			text-align: center;
			margin-bottom: 40px;
			padding-bottom: 30px;
			border-bottom: 1px solid rgba(0, 0, 0, 0.08);
		}
		
		.favorites-header-icon {
			font-size: 48px;
			background: linear-gradient(135deg, #feca57, #ff9f43);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 16px;
			display: block;
		}
		
		.favorites-header-title {
			font-size: 32px;
			font-weight: 700;
			background: linear-gradient(135deg, #feca57, #ff9f43);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			margin-bottom: 12px;
		}
		
		.favorites-header-subtitle {
			color: #718096;
			font-size: 16px;
		}
		
		.favorites-total-count {
			font-weight: 600;
			color: #ff9f43;
		}
		
		/* ç­›é€‰æ ‡ç­¾åŒºåŸŸ */
		.favorites-filters {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
			justify-content: center;
			margin-bottom: 32px;
			padding-bottom: 24px;
			border-bottom: 1px solid rgba(0, 0, 0, 0.06);
		}
		
		.filter-tag {
			display: inline-flex;
			align-items: center;
			gap: 8px;
			padding: 10px 20px;
			background: linear-gradient(145deg, #f8fafc, #fff);
			border: 1px solid rgba(254, 202, 87, 0.15);
			border-radius: 30px;
			font-size: 14px;
			color: #4a5568;
			cursor: pointer;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			text-decoration: none;
		}
		
		.filter-tag:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(254, 202, 87, 0.2);
			background: linear-gradient(135deg, #feca57, #ff9f43);
			color: #fff;
			text-decoration: none;
		}
		
		.filter-tag.active {
			background: linear-gradient(135deg, #feca57, #ff9f43);
			color: #fff;
			border-color: transparent;
			box-shadow: 0 6px 20px rgba(254, 202, 87, 0.3);
		}
		
		.filter-tag .count {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			min-width: 24px;
			height: 24px;
			padding: 0 8px;
			background: rgba(254, 202, 87, 0.1);
			border-radius: 12px;
			font-size: 12px;
			font-weight: 600;
			color: #ff9f43;
			transition: all 0.3s ease;
		}
		
		.filter-tag:hover .count,
		.filter-tag.active .count {
			background: rgba(255, 255, 255, 0.25);
			color: #fff;
		}
		
		/* æ”¶è—å¡ç‰‡ç½‘æ ¼ */
		.favorites-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
			gap: 20px;
		}
		
		/* æ”¶è—å¡ç‰‡ - å‚è€ƒdemoé£æ ¼ */
		.favorite-card {
			background: #fff;
			border-radius: 16px;
			overflow: hidden;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
			transition: all 0.3s ease;
			cursor: pointer;
			display: flex;
			flex-direction: column;
			height: 100%;
		}
		
		.favorite-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(254, 202, 87, 0.2);
		}
		
		.favorite-card.clicked {
			transform: scale(0.98);
			transition: transform 0.1s ease;
		}
		
		.favorite-cover {
			width: 100%;
			height: 180px;
			object-fit: cover;
			transition: transform 0.3s ease;
		}
		
		.favorite-card:hover .favorite-cover {
			transform: scale(1.05);
		}
		
		.favorite-content {
			padding: 20px;
			flex: 1;
			display: flex;
			flex-direction: column;
		}
		
		.favorite-type {
			display: inline-flex;
			align-items: center;
			gap: 5px;
			padding: 4px 12px;
			border-radius: 12px;
			font-size: 12px;
			font-weight: 600;
			margin-bottom: 10px;
			align-self: flex-start;
		}
		
		.favorite-title {
			font-size: 16px;
			font-weight: 600;
			color: #333;
			margin-bottom: 8px;
			line-height: 1.4;
			display: -webkit-box;
			-webkit-line-clamp: 2;
			-webkit-box-orient: vertical;
			overflow: hidden;
		}
		
		.favorite-summary {
			font-size: 14px;
			color: #666;
			line-height: 1.6;
			display: -webkit-box;
			-webkit-line-clamp: 3;
			-webkit-box-orient: vertical;
			overflow: hidden;
			margin-bottom: 12px;
			flex: 1;
		}
		
		.favorite-meta {
			display: flex;
			justify-content: space-between;
			align-items: center;
			font-size: 12px;
			color: #999;
			margin-top: auto;
		}
		
		.favorite-source {
			display: flex;
			align-items: center;
			gap: 5px;
		}
		
		.favorite-tags {
			display: flex;
			gap: 5px;
			margin-top: 12px;
			flex-wrap: wrap;
		}
		
		.tag {
			padding: 3px 8px;
			background: rgba(254, 202, 87, 0.1);
			border-radius: 10px;
			font-size: 11px;
			color: #ff9f43;
		}
		
		/* ç©ºçŠ¶æ€ */
		.favorites-empty {
			text-align: center;
			padding: 60px 20px;
			color: #718096;
		}
		
		.favorites-empty i {
			font-size: 64px;
			margin-bottom: 20px;
			opacity: 0.3;
		}
		
		.favorites-empty p {
			font-size: 16px;
		}
		
		/* åº•éƒ¨ */
		.favorites-footer {
			background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.9));
			backdrop-filter: blur(10px);
			position: fixed;
			bottom: 0;
			left: 0;
			right: 0;
			z-index: 1000;
		}
		
		.footer-text {
			font-size: 14px;
			letter-spacing: 1px;
		}
		
		/* å“åº”å¼ */
		@media (max-width: 768px) {
			.favorites-main-card {
				padding: 24px 16px;
				margin: 10px;
				border-radius: 20px;
			}
			
			.favorites-header-icon { font-size: 36px; }
			.favorites-header-title { font-size: 24px; }
			
			.favorites-grid {
				grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
				gap: 16px;
			}
			
			.favorites-filters { gap: 8px; }
			.filter-tag { padding: 8px 14px; font-size: 13px; }
		}
		
		@media (max-width: 480px) {
			.favorites-grid {
				grid-template-columns: 1fr;
			}
		}
		
		/* éšè—è¯¦æƒ… */
		.photo-detail {
			display: none !important;
		}
		
		/* ========== ä¾§è¾¹æ»‘å‡ºé¢æ¿æ ·å¼ ========== */
		
		/* é€‰ä¸­çŠ¶æ€çš„å¡ç‰‡ */
		.favorite-card.active {
			box-shadow: 0 0 0 3px #ff9f43, 0 10px 30px rgba(254, 202, 87, 0.3);
			transform: translateY(-5px);
		}
		
		/* é®ç½©å±‚ */
		.detail-overlay {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.5);
			z-index: 1999;
			opacity: 0;
			visibility: hidden;
			transition: all 0.3s ease;
			backdrop-filter: blur(4px);
		}
		
		.detail-overlay.show {
			opacity: 1;
			visibility: visible;
		}
		
		/* ä¾§è¾¹é¢æ¿ */
		.detail-panel {
			position: fixed;
			top: 0;
			right: 0;
			width: 580px;
			max-width: 100%;
			height: 100vh;
			background: #fff;
			z-index: 2000;
			transform: translateX(100%);
			transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
			display: flex;
			flex-direction: column;
			box-shadow: -10px 0 40px rgba(0, 0, 0, 0.15);
		}
		
		.detail-panel.show {
			transform: translateX(0);
		}
		
		/* é¢æ¿å¤´éƒ¨ */
		.panel-header {
			padding: 20px 24px;
			background: linear-gradient(135deg, #feca57, #ff9f43);
			display: flex;
			align-items: center;
			justify-content: space-between;
			flex-shrink: 0;
		}
		
		.panel-nav {
			display: flex;
			align-items: center;
			gap: 8px;
		}
		
		.panel-nav-btn {
			width: 38px;
			height: 38px;
			border-radius: 10px;
			background: rgba(255, 255, 255, 0.2);
			border: none;
			cursor: pointer;
			color: #fff;
			font-size: 16px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.2s ease;
		}
		
		.panel-nav-btn:hover:not(:disabled) {
			background: rgba(255, 255, 255, 0.35);
			transform: scale(1.05);
		}
		
		.panel-nav-btn:disabled {
			opacity: 0.4;
			cursor: not-allowed;
		}
		
		.panel-counter {
			color: #fff;
			font-size: 14px;
			font-weight: 500;
			padding: 0 12px;
		}
		
		.panel-close {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			background: rgba(255, 255, 255, 0.2);
			border: none;
			cursor: pointer;
			color: #fff;
			font-size: 20px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.25s ease;
		}
		
		.panel-close:hover {
			background: rgba(255, 255, 255, 0.35);
			transform: rotate(90deg);
		}
		
		/* é¢æ¿å†…å®¹ */
		.panel-body {
			flex: 1;
			overflow-y: auto;
			overflow-x: hidden;
			padding: 0;
		}
		
		/* è¯¦æƒ…å°é¢ */
		.detail-cover-wrap {
			position: relative;
			width: 100%;
			background: #f8fafc;
		}
		
		.detail-cover {
			width: 100%;
			max-height: 320px;
			object-fit: contain;
			display: block;
			background: #f1f5f9;
		}
		
		.detail-cover-overlay {
			position: absolute;
			bottom: 0;
			left: 0;
			right: 0;
			height: 80px;
			background: linear-gradient(to top, #fff, transparent);
		}
		
		/* è¯¦æƒ…ä¸»ä½“ */
		.detail-main {
			padding: 24px;
		}
		
		/* è¯¦æƒ…å¤´éƒ¨ */
		.detail-header {
			margin-bottom: 20px;
		}
		
		.detail-type {
			display: inline-flex;
			align-items: center;
			gap: 6px;
			padding: 6px 14px;
			border-radius: 20px;
			font-size: 13px;
			font-weight: 600;
			margin-bottom: 12px;
		}
		
		.detail-title {
			font-size: 20px;
			font-weight: 700;
			color: #1a202c;
			line-height: 1.5;
			margin: 0 0 12px 0;
		}
		
		.detail-meta {
			display: flex;
			align-items: center;
			gap: 16px;
			font-size: 13px;
			color: #718096;
			flex-wrap: wrap;
		}
		
		.detail-meta-item {
			display: flex;
			align-items: center;
			gap: 5px;
		}
		
		.detail-meta-item i {
			color: #a0aec0;
		}
		
		/* æ”¶è—ç†ç”± */
		.detail-reason {
			background: linear-gradient(135deg, #fffbeb, #fef3c7);
			border-left: 4px solid #f59e0b;
			border-radius: 0 12px 12px 0;
			padding: 16px 20px;
			margin-bottom: 20px;
		}
		
		.detail-reason-label {
			font-size: 13px;
			font-weight: 600;
			color: #d97706;
			margin-bottom: 6px;
			display: flex;
			align-items: center;
			gap: 6px;
		}
		
		.detail-reason-text {
			font-size: 15px;
			color: #92400e;
			line-height: 1.7;
		}
		
		/* æ­£æ–‡å†…å®¹ */
		.detail-content {
			font-size: 15px;
			color: #4a5568;
			line-height: 1.9;
			white-space: pre-wrap;
			word-break: break-word;
			margin-bottom: 24px;
			padding: 20px;
			background: #f8fafc;
			border-radius: 12px;
		}
		
		/* åˆ†éš”åŒºåŸŸæ ‡é¢˜ */
		.detail-section-title {
			font-size: 14px;
			font-weight: 600;
			color: #4a5568;
			margin-bottom: 14px;
			display: flex;
			align-items: center;
			gap: 8px;
			padding-bottom: 8px;
			border-bottom: 2px solid #edf2f7;
		}
		
		.detail-section-title i {
			color: #ff9f43;
		}
		
		/* å›¾ç‰‡ç”»å»Š */
		.detail-gallery {
			margin-bottom: 24px;
		}
		
		.detail-images {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 10px;
		}
		
		.detail-image-item {
			position: relative;
			border-radius: 10px;
			overflow: hidden;
			aspect-ratio: 1;
			cursor: pointer;
			box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			transition: all 0.25s ease;
		}
		
		.detail-image-item:hover {
			transform: translateY(-3px);
			box-shadow: 0 6px 20px rgba(0,0,0,0.12);
		}
		
		.detail-image-item img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			transition: transform 0.3s ease;
		}
		
		.detail-image-item:hover img {
			transform: scale(1.08);
		}
		
		.detail-image-item .image-overlay {
			position: absolute;
			inset: 0;
			background: linear-gradient(to top, rgba(0,0,0,0.6), transparent 60%);
			opacity: 0;
			transition: opacity 0.25s ease;
			display: flex;
			align-items: flex-end;
			justify-content: center;
			padding-bottom: 8px;
		}
		
		.detail-image-item:hover .image-overlay {
			opacity: 1;
		}
		
		.detail-image-item .image-overlay span {
			color: #fff;
			font-size: 11px;
		}
		
		/* è§†é¢‘åŒºåŸŸ */
		.detail-videos {
			margin-bottom: 24px;
		}
		
		.detail-video-item {
			background: #000;
			border-radius: 12px;
			overflow: hidden;
		}
		
		.detail-video-item video {
			width: 100%;
			display: block;
			max-height: 300px;
		}
		
		/* éŸ³é¢‘åŒºåŸŸ */
		.detail-audios {
			margin-bottom: 24px;
		}
		
		.detail-audio-item {
			background: linear-gradient(135deg, #667eea, #764ba2);
			border-radius: 12px;
			padding: 16px 20px;
			display: flex;
			align-items: center;
			gap: 14px;
			margin-bottom: 10px;
		}
		
		.detail-audio-icon {
			width: 44px;
			height: 44px;
			background: rgba(255,255,255,0.2);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 18px;
			color: #fff;
			flex-shrink: 0;
		}
		
		.detail-audio-info {
			flex: 1;
			color: #fff;
			min-width: 0;
		}
		
		.detail-audio-title {
			font-weight: 600;
			margin-bottom: 3px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}
		
		.detail-audio-artist {
			font-size: 13px;
			opacity: 0.8;
		}
		
		/* æ ‡ç­¾ */
		.detail-tags {
			display: flex;
			gap: 8px;
			flex-wrap: wrap;
			padding-top: 16px;
			border-top: 1px solid #e2e8f0;
		}
		
		.detail-tag {
			padding: 6px 14px;
			background: linear-gradient(135deg, #fef3c7, #fde68a);
			border-radius: 20px;
			font-size: 12px;
			font-weight: 500;
			color: #d97706;
		}
		
		/* é”®ç›˜æç¤º */
		.panel-tips {
			padding: 12px 24px;
			background: #f8fafc;
			border-top: 1px solid #edf2f7;
			font-size: 12px;
			color: #a0aec0;
			text-align: center;
			flex-shrink: 0;
		}
		
		.panel-tips kbd {
			display: inline-block;
			padding: 2px 6px;
			background: #e2e8f0;
			border-radius: 4px;
			font-family: inherit;
			font-size: 11px;
			color: #4a5568;
			margin: 0 2px;
		}
		
		/* å“åº”å¼è°ƒæ•´ */
		@media (max-width: 640px) {
			.detail-panel {
				width: 100%;
			}
			
			.panel-header {
				padding: 16px 20px;
			}
			
			.detail-main {
				padding: 20px;
			}
			
			.detail-title {
				font-size: 18px;
			}
			
			.detail-content {
				font-size: 14px;
				padding: 16px;
			}
			
			.detail-images {
				grid-template-columns: repeat(2, 1fr);
				gap: 8px;
			}
			
			.panel-tips {
				display: none;
			}
		}
	</style>
</head>

<body class="favorites-page">
	<header>
		<nav class="navbar navbar-expand-lg navbar-dark fixed-top favorites-navbar">
			<a class="navbar-brand" target="_blank" href="https://github.com/2015winter/QZoneExporter">
				<i class="fa fa-cloud-download mr-2"></i>QQç©ºé—´å¯¼å‡ºåŠ©æ‰‹
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb favorites-breadcrumb">
						<li class="breadcrumb-item"><a href="../index.html"><i class="fa fa-home mr-1"></i>ä¸ªäººä¸­å¿ƒ</a></li>
						<li class="breadcrumb-item active" aria-current="page"><i class="fa fa-star mr-1"></i>æ”¶è—</li>
					</ol>
				</nav>
			</div>
		</nav>
	</header>
	
	<main role="main" class="flex-shrink-0">
		<div class="container">
			<div class="favorites-main-card">
				<!-- é¡µé¢æ ‡é¢˜ -->
				<div class="favorites-header">
					<i class="fa fa-star favorites-header-icon"></i>
					<h1 class="favorites-header-title">æˆ‘çš„æ”¶è—</h1>
					<p class="favorites-header-subtitle">å…± <span class="favorites-total-count" id="favorites-count">0</span> æ¡æ”¶è—ï¼Œè®°å½•äº†é‚£äº›æ‰“åŠ¨ä½ çš„ç¬é—´</p>
				</div>
				
				<!-- ç­›é€‰æ ‡ç­¾ -->
				<div class="favorites-filters" id="favorites-filters">
					<button class="filter-tag active" data-type="all"><i class="fa fa-star"></i> å…¨éƒ¨ <span class="count" id="filter-all">0</span></button>
					<button class="filter-tag" data-type="article"><i class="fa fa-file-text"></i> è¯´è¯´æ—¥å¿— <span class="count" id="filter-article">0</span></button>
					<button class="filter-tag" data-type="music"><i class="fa fa-music"></i> éŸ³ä¹ <span class="count" id="filter-music">0</span></button>
					<button class="filter-tag" data-type="video"><i class="fa fa-video-camera"></i> è§†é¢‘ <span class="count" id="filter-video">0</span></button>
					<button class="filter-tag" data-type="photo"><i class="fa fa-image"></i> å›¾ç‰‡ <span class="count" id="filter-photo">0</span></button>
				</div>
				
				<!-- æ”¶è—ç½‘æ ¼ - é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
				<div class="favorites-grid" id="favorites-grid"></div>
				
				<!-- ç©ºçŠ¶æ€ -->
				<div class="favorites-empty" id="favorites-empty" style="display: none;">
					<i class="fa fa-star"></i>
					<p>æš‚æ— æ”¶è—å†…å®¹</p>
				</div>
			</div>
		</div>
	</main>
	
	<footer class="footer mt-auto py-3 favorites-footer">
		<div class="container text-center">
			<span class="text-white footer-text">
				<i class="fa fa-star mr-2"></i>æ”¶è—ç¾å¥½ï¼Œçè—å›å¿†
			</span>
		</div>
	</footer>
	
	<!-- ä¾§è¾¹è¯¦æƒ…é¢æ¿ -->
	<div class="detail-overlay" id="detail-overlay"></div>
	<div class="detail-panel" id="detail-panel">
		<div class="panel-header">
			<div class="panel-nav">
				<button class="panel-nav-btn" id="btn-prev" title="ä¸Šä¸€æ¡ (â†)"><i class="fa fa-chevron-left"></i></button>
				<span class="panel-counter"><span id="current-index">1</span> / <span id="total-count">0</span></span>
				<button class="panel-nav-btn" id="btn-next" title="ä¸‹ä¸€æ¡ (â†’)"><i class="fa fa-chevron-right"></i></button>
			</div>
			<button class="panel-close" id="btn-close" title="å…³é—­ (Esc)"><i class="fa fa-times"></i></button>
		</div>
		<div class="panel-body" id="panel-body">
			<!-- åŠ¨æ€å†…å®¹ -->
		</div>
		<div class="panel-tips">
			<kbd>â†</kbd> ä¸Šä¸€æ¡ &nbsp;&nbsp; <kbd>â†’</kbd> ä¸‹ä¸€æ¡ &nbsp;&nbsp; <kbd>Esc</kbd> å…³é—­
		</div>
	</div>
	
	<script>
	// å½“å‰ç­›é€‰ç±»å‹
	var currentFilter = 'all';
	// å½“å‰é€‰ä¸­çš„å¡ç‰‡ç´¢å¼•
	var currentIndex = -1;
	// é¢æ¿æ˜¯å¦æ‰“å¼€
	var isPanelOpen = false;
	// lightgalleryå®ä¾‹
	var lgInstance = null;
	
	// æ”¶è—æ•°æ® - ä»json/favorites.jsåŠ è½½çš„å…¨å±€å˜é‡favorites
	// æ¨¡æ¿æ¸²æŸ“æ—¶å°†æ•°æ®è½¬æ¢ä¸ºæ•°ç»„
	var allFavorites = [];
	<%if(typeof dataMaps !== 'undefined' && dataMaps) {%>
		<%for (const [year, yearMap] of dataMaps) {%>
			<%for (const [month, monthItems] of yearMap) {%>
				<%for (let index = 0; index < monthItems.length; index++) {%>
					<%const favorite = monthItems[index]%>
	allFavorites.push(<%:=JSON.stringify(favorite)%>);
				<%}%>
			<%}%>
		<%}%>
	<%}%>
	
	// å¦‚æœæ¨¡æ¿æ•°æ®ä¸ºç©ºï¼Œå°è¯•ä»å…¨å±€å˜é‡favoritesè·å–
	if (allFavorites.length === 0 && typeof favorites !== 'undefined' && Array.isArray(favorites)) {
		allFavorites = favorites;
	}
	
	// åˆå§‹åŒ–é¡µé¢
	function init() {
		console.log('åˆå§‹åŒ–æ”¶è—é¡µé¢ï¼Œæ•°æ®é‡:', allFavorites.length);
		
		// ä¸ºæ¯ä¸ªæ”¶è—è®¡ç®—ç±»å‹é”®å€¼
		allFavorites.forEach(function(fav) {
			fav._typeKey = FavoritesHelper.getTypeKey(fav);
		});
		
		updateStats();
		renderFavorites();
		bindEvents();
	}
	
	// æ›´æ–°ç»Ÿè®¡
	function updateStats() {
		var total = allFavorites.length;
		var articleCount = allFavorites.filter(function(f) { return f._typeKey === 'article'; }).length;
		var musicCount = allFavorites.filter(function(f) { return f._typeKey === 'music'; }).length;
		var videoCount = allFavorites.filter(function(f) { return f._typeKey === 'video'; }).length;
		var photoCount = allFavorites.filter(function(f) { return f._typeKey === 'photo'; }).length;
		
		// æ›´æ–°æ ‡é¢˜ç»Ÿè®¡æ•°å­—
		$('#favorites-count').text(total);
		
		// æ›´æ–°ç­›é€‰æ ‡ç­¾æ•°å­—
		$('#filter-all').text(total);
		$('#filter-article').text(articleCount);
		$('#filter-music').text(musicCount);
		$('#filter-video').text(videoCount);
		$('#filter-photo').text(photoCount);
	}
	
	// æ¸²æŸ“æ”¶è—åˆ—è¡¨
	function renderFavorites() {
		var grid = document.getElementById('favorites-grid');
		var emptyState = document.getElementById('favorites-empty');
		
		var filteredList = getFilteredList();
		
		if (filteredList.length === 0) {
			grid.style.display = 'none';
			emptyState.style.display = 'block';
			return;
		}
		
		grid.style.display = 'grid';
		emptyState.style.display = 'none';
		
		grid.innerHTML = filteredList.map(function(fav, index) {
			var typeInfo = FavoritesHelper.getTypeInfo(fav.type);
			var owner = FavoritesHelper.getFavoriteOwner(fav);
			
			// å°é¢å›¾ç‰‡
			var coverImage = '../Common/images/loading.gif';
			if (fav.custom_origin_images && fav.custom_origin_images.length > 0) {
				coverImage = fav.custom_origin_images[0].custom_filepath || fav.custom_origin_images[0].custom_url || coverImage;
			} else if (fav.custom_images && fav.custom_images.length > 0) {
				coverImage = fav.custom_images[0].custom_filepath || fav.custom_images[0].custom_url || coverImage;
			} else if (fav.custom_videos && fav.custom_videos.length > 0) {
				coverImage = fav.custom_videos[0].custom_pre_filepath || fav.custom_videos[0].preview_img || '../Common/images/video-play.png';
			} else if (fav.custom_audios && fav.custom_audios.length > 0) {
				coverImage = fav.custom_audios[0].custom_pre_filepath || fav.custom_audios[0].preview_img || '../Common/images/loading.gif';
			}
			
			// æ ‡é¢˜
			var title = getTitle(fav);
			var shortTitle = title.length > 50 ? title.substring(0, 50) + '...' : title;
			
			// æ‘˜è¦
			var summary = getSummary(fav);
			
			// æ ‡ç­¾HTML
			var tagsHtml = '';
			if (fav.type === 5 || fav.type === 3) {
				tagsHtml = '<div class="favorite-tags"><span class="tag">#' + FavoritesHelper.getType(fav.type) + '</span>';
				if (fav.custom_videos && fav.custom_videos.length > 0) {
					tagsHtml += '<span class="tag">#è§†é¢‘</span>';
				}
				if ((fav.custom_origin_images && fav.custom_origin_images.length > 0) || (fav.custom_images && fav.custom_images.length > 0)) {
					tagsHtml += '<span class="tag">#å›¾ç‰‡</span>';
				}
				if (fav.custom_audios && fav.custom_audios.length > 0) {
					tagsHtml += '<span class="tag">#éŸ³ä¹</span>';
				}
				tagsHtml += '</div>';
			}
			
			return '<div class="favorite-card" data-type="' + fav._typeKey + '" data-index="' + index + '">' +
				'<img class="favorite-cover lazyload" src="' + FavoritesHelper.escapeHtml(coverImage) + '" alt="' + FavoritesHelper.escapeHtml(shortTitle) + '" onerror="this.src=\'../Common/images/loading.gif\'">' +
				'<div class="favorite-content">' +
					'<span class="favorite-type" style="background: ' + typeInfo.color + '20; color: ' + typeInfo.color + '">' +
						typeInfo.icon + ' ' + typeInfo.name +
					'</span>' +
					'<h3 class="favorite-title">' + FavoritesHelper.escapeHtml(shortTitle) + '</h3>' +
					'<p class="favorite-summary">' + FavoritesHelper.escapeHtml(summary) + '</p>' +
					'<div class="favorite-meta">' +
						'<span class="favorite-source"><i class="fa fa-user"></i> ' + FavoritesHelper.escapeHtml(owner.name) + '</span>' +
						'<span>' + (fav.custom_create_time || '') + '</span>' +
					'</div>' +
					tagsHtml +
				'</div>' +
			'</div>';
		}).join('');
		
		// é‡æ–°åˆå§‹åŒ–æ‡’åŠ è½½
		if (typeof LazyLoad !== 'undefined') {
			new LazyLoad({ elements_selector: ".lazyload" });
		}
		
		// å…³é—­é¢æ¿å¹¶é‡ç½®çŠ¶æ€
		closePanel();
	}
	
	// è·å–ç­›é€‰åçš„åˆ—è¡¨
	function getFilteredList() {
		if (currentFilter === 'all') {
			return allFavorites;
		}
		return allFavorites.filter(function(f) { return f._typeKey === currentFilter; });
	}
	
	// è·å–æ ‡é¢˜
	function getTitle(fav) {
		if (fav.title && fav.title.trim() !== '') {
			return fav.title;
		} else if (fav.type === 5 && fav.shuoshuo_info && fav.shuoshuo_info.detail_shuoshuo_info && fav.shuoshuo_info.detail_shuoshuo_info.content) {
			return fav.shuoshuo_info.detail_shuoshuo_info.content;
		} else if (fav.abstract || fav.desp) {
			return fav.abstract || fav.desp;
		}
		return 'æ”¶è—å†…å®¹';
	}
	
	// è·å–æ‘˜è¦
	function getSummary(fav) {
		if (fav.shuoshuo_info && fav.shuoshuo_info.reason && fav.shuoshuo_info.reason.trim() !== '') {
			return fav.shuoshuo_info.reason;
		} else if (fav.share_info && fav.share_info.reason && fav.share_info.reason.trim() !== '') {
			return fav.share_info.reason;
		} else if (fav.abstract && fav.abstract.trim() !== '') {
			return fav.abstract;
		} else if (fav.desp && fav.desp.trim() !== '') {
			return fav.desp;
		}
		return 'æš‚æ— æè¿°';
	}
	
	// æ‰“å¼€ä¾§è¾¹é¢æ¿
	function openPanel(index) {
		var filteredList = getFilteredList();
		if (index < 0 || index >= filteredList.length) return;
		
		currentIndex = index;
		isPanelOpen = true;
		
		// æ›´æ–°å¡ç‰‡é€‰ä¸­çŠ¶æ€
		$('.favorite-card').removeClass('active');
		$('.favorite-card[data-index="' + index + '"]').addClass('active');
		
		// æ˜¾ç¤ºé®ç½©å’Œé¢æ¿
		$('#detail-overlay').addClass('show');
		$('#detail-panel').addClass('show');
		
		// ç¦æ­¢bodyæ»šåŠ¨
		$('body').css('overflow', 'hidden');
		
		// æ¸²æŸ“è¯¦æƒ…å†…å®¹
		renderPanelContent(index);
		
		// æ›´æ–°å¯¼èˆªçŠ¶æ€
		updateNavState();
	}
	
	// å…³é—­ä¾§è¾¹é¢æ¿
	function closePanel() {
		isPanelOpen = false;
		currentIndex = -1;
		
		// ç§»é™¤å¡ç‰‡é€‰ä¸­çŠ¶æ€
		$('.favorite-card').removeClass('active');
		
		// éšè—é®ç½©å’Œé¢æ¿
		$('#detail-overlay').removeClass('show');
		$('#detail-panel').removeClass('show');
		
		// æ¢å¤bodyæ»šåŠ¨
		$('body').css('overflow', '');
		
		// é”€æ¯lightgalleryå®ä¾‹
		if (lgInstance) {
			lgInstance.destroy();
			lgInstance = null;
		}
		
		// æ¸…ç©ºé¢æ¿å†…å®¹
		$('#panel-body').html('');
	}
	
	// æ¸²æŸ“é¢æ¿å†…å®¹
	function renderPanelContent(index) {
		var filteredList = getFilteredList();
		var fav = filteredList[index];
		if (!fav) return;
		
		var typeInfo = FavoritesHelper.getTypeInfo(fav.type);
		var owner = FavoritesHelper.getFavoriteOwner(fav);
		var title = getTitle(fav);
		var reason = FavoritesHelper.getReason(fav);
		var content = FavoritesHelper.getFullContent(fav);
		var images = fav.custom_origin_images || fav.custom_images || [];
		var videos = fav.custom_videos || [];
		var audios = fav.custom_audios || [];
		
		// å°é¢å›¾ç‰‡
		var coverImage = '';
		if (images.length > 0) {
			coverImage = images[0].custom_filepath || images[0].custom_url || '';
		} else if (videos.length > 0) {
			coverImage = videos[0].custom_pre_filepath || videos[0].preview_img || '';
		}
		
		var html = '';
		
		// å°é¢å›¾ï¼ˆå¦‚æœæœ‰ï¼‰
		if (coverImage) {
			html += '<div class="detail-cover-wrap">' +
				'<img class="detail-cover" src="' + FavoritesHelper.escapeHtml(coverImage) + '" alt="å°é¢" onerror="this.parentNode.style.display=\'none\'">' +
				'<div class="detail-cover-overlay"></div>' +
			'</div>';
		}
		
		// è¯¦æƒ…ä¸»ä½“
		html += '<div class="detail-main">';
		
		// å¤´éƒ¨ä¿¡æ¯
		html += '<div class="detail-header">' +
			'<span class="detail-type" style="background: ' + typeInfo.color + '20; color: ' + typeInfo.color + '">' +
				typeInfo.icon + ' ' + typeInfo.name +
			'</span>' +
			'<h2 class="detail-title">' + FavoritesHelper.escapeHtml(title) + '</h2>' +
			'<div class="detail-meta">' +
				'<span class="detail-meta-item"><i class="fa fa-user"></i> ' + FavoritesHelper.escapeHtml(owner.name) + '</span>' +
				'<span class="detail-meta-item"><i class="fa fa-clock-o"></i> ' + (fav.custom_create_time || 'æœªçŸ¥æ—¶é—´') + '</span>' +
			'</div>' +
		'</div>';
		
		// æ”¶è—ç†ç”±
		if (reason && reason.trim() !== '') {
			html += '<div class="detail-reason">' +
				'<div class="detail-reason-label"><i class="fa fa-quote-left"></i> æ”¶è—ç†ç”±</div>' +
				'<div class="detail-reason-text">' + FavoritesHelper.escapeHtml(reason) + '</div>' +
			'</div>';
		}
		
		// æ­£æ–‡å†…å®¹
		if (content && content.trim() !== '' && content !== 'æš‚æ— å†…å®¹') {
			html += '<div class="detail-content">' + FavoritesHelper.escapeHtml(content) + '</div>';
		}
		
		// è§†é¢‘
		if (videos.length > 0) {
			html += '<div class="detail-videos">' +
				'<div class="detail-section-title"><i class="fa fa-video-camera"></i> è§†é¢‘ (' + videos.length + 'ä¸ª)</div>';
			videos.forEach(function(video) {
				var videoSrc = video.custom_filepath || video.custom_url || video.video_url || '';
				if (videoSrc) {
					html += '<div class="detail-video-item"><video controls preload="metadata" src="' + FavoritesHelper.escapeHtml(videoSrc) + '"></video></div>';
				}
			});
			html += '</div>';
		}
		
		// å›¾ç‰‡ç”»å»Š
		if (images.length > 0) {
			html += '<div class="detail-gallery">' +
				'<div class="detail-section-title"><i class="fa fa-image"></i> å›¾ç‰‡ (' + images.length + 'å¼ ) - ç‚¹å‡»æŸ¥çœ‹åŸå›¾</div>' +
				'<div class="detail-images" id="gallery-container">';
			images.forEach(function(img, imgIndex) {
				var src = img.custom_filepath || img.custom_url || '../Common/images/loading.gif';
				var thumbSrc = img.custom_pre_filepath || src;
				html += '<a class="detail-image-item lightbox" href="' + FavoritesHelper.escapeHtml(src) + '">' +
					'<img src="' + FavoritesHelper.escapeHtml(thumbSrc) + '" alt="å›¾ç‰‡' + (imgIndex + 1) + '">' +
					'<div class="image-overlay"><span><i class="fa fa-search-plus"></i> æŸ¥çœ‹</span></div>' +
				'</a>';
			});
			html += '</div></div>';
		}
		
		// éŸ³é¢‘
		if (audios.length > 0) {
			html += '<div class="detail-audios">' +
				'<div class="detail-section-title"><i class="fa fa-music"></i> éŸ³ä¹ (' + audios.length + 'é¦–)</div>';
			audios.forEach(function(audio) {
				var audioTitle = audio.name || audio.title || 'æœªçŸ¥æ­Œæ›²';
				var audioArtist = audio.singer || audio.artist || 'æœªçŸ¥æ­Œæ‰‹';
				html += '<div class="detail-audio-item">' +
					'<div class="detail-audio-icon"><i class="fa fa-music"></i></div>' +
					'<div class="detail-audio-info">' +
						'<div class="detail-audio-title">' + FavoritesHelper.escapeHtml(audioTitle) + '</div>' +
						'<div class="detail-audio-artist">' + FavoritesHelper.escapeHtml(audioArtist) + '</div>' +
					'</div>' +
				'</div>';
			});
			html += '</div>';
		}
		
		// åº•éƒ¨æ ‡ç­¾
		html += '<div class="detail-tags">' +
			'<span class="detail-tag">#' + FavoritesHelper.getType(fav.type) + '</span>';
		if (videos.length > 0) html += '<span class="detail-tag">#è§†é¢‘</span>';
		if (images.length > 0) html += '<span class="detail-tag">#å›¾ç‰‡' + images.length + 'å¼ </span>';
		if (audios.length > 0) html += '<span class="detail-tag">#éŸ³ä¹</span>';
		html += '</div>';
		
		html += '</div>'; // ç»“æŸ detail-main
		
		// å¡«å……é¢æ¿å†…å®¹
		$('#panel-body').html(html);
		
		// æ»šåŠ¨åˆ°é¡¶éƒ¨
		$('#panel-body').scrollTop(0);
		
		// åˆå§‹åŒ–lightgallery
		setTimeout(function() {
			var galleryEl = document.getElementById('gallery-container');
			if (galleryEl && typeof lightGallery !== 'undefined') {
				if (lgInstance) {
					lgInstance.destroy();
				}
				lgInstance = lightGallery(galleryEl, {
					selector: '.lightbox',
					download: true,
					zoom: true,
					rotate: true,
					fullScreen: true,
					thumbnail: true,
					animateThumb: true,
					showThumbByDefault: false
				});
			}
		}, 100);
	}
	
	// æ›´æ–°å¯¼èˆªçŠ¶æ€
	function updateNavState() {
		var filteredList = getFilteredList();
		var total = filteredList.length;
		
		$('#current-index').text(currentIndex + 1);
		$('#total-count').text(total);
		
		// æ›´æ–°æŒ‰é’®çŠ¶æ€
		$('#btn-prev').prop('disabled', currentIndex <= 0);
		$('#btn-next').prop('disabled', currentIndex >= total - 1);
	}
	
	// ä¸Šä¸€æ¡
	function goPrev() {
		if (currentIndex > 0) {
			openPanel(currentIndex - 1);
		}
	}
	
	// ä¸‹ä¸€æ¡
	function goNext() {
		var filteredList = getFilteredList();
		if (currentIndex < filteredList.length - 1) {
			openPanel(currentIndex + 1);
		}
	}
	
	// ç»‘å®šäº‹ä»¶
	function bindEvents() {
		// ç­›é€‰æ ‡ç­¾ç‚¹å‡»
		$('.filter-tag').on('click', function() {
			$('.filter-tag').removeClass('active');
			$(this).addClass('active');
			currentFilter = $(this).data('type');
			renderFavorites();
		});
		
		// å¡ç‰‡ç‚¹å‡» - æ‰“å¼€ä¾§è¾¹é¢æ¿
		$('#favorites-grid').on('click', '.favorite-card', function(e) {
			var index = parseInt($(this).data('index'));
			openPanel(index);
		});
		
		// å…³é—­æŒ‰é’®ç‚¹å‡»
		$('#btn-close').on('click', closePanel);
		
		// é®ç½©ç‚¹å‡»å…³é—­
		$('#detail-overlay').on('click', closePanel);
		
		// ä¸Šä¸€æ¡/ä¸‹ä¸€æ¡æŒ‰é’®
		$('#btn-prev').on('click', goPrev);
		$('#btn-next').on('click', goNext);
		
		// é”®ç›˜äº‹ä»¶
		$(document).on('keydown', function(e) {
			if (!isPanelOpen) return;
			
			// ESC å…³é—­é¢æ¿
			if (e.keyCode === 27) {
				closePanel();
				e.preventDefault();
			}
			// å·¦ç®­å¤´ - ä¸Šä¸€æ¡
			else if (e.keyCode === 37) {
				goPrev();
				e.preventDefault();
			}
			// å³ç®­å¤´ - ä¸‹ä¸€æ¡
			else if (e.keyCode === 39) {
				goNext();
				e.preventDefault();
			}
		});
		
		// é˜»æ­¢é¢æ¿å†…ç‚¹å‡»äº‹ä»¶å†’æ³¡åˆ°é®ç½©
		$('#detail-panel').on('click', function(e) {
			e.stopPropagation();
		});
	}
	
	// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
	$(function() {
		init();
	});
	</script>
</body>

</html>
